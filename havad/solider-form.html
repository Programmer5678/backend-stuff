<!DOCTYPE html>
<html lang="he" dir="rtl">

<head>
  <meta charset="UTF-8">
  <title>חוות דעת לקצונה</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      direction: rtl;
      padding: 20px;
    }

    label {
      display: block;
      margin-top: 10px;
      font-weight: bold;
    }

    input,
    select,
    textarea {
      width: 100%;
      margin-bottom: 10px;
      padding: 5px;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      margin-bottom: 20px;
    }

    th,
    td {
      border: 1px solid #ccc;
      padding: 8px;
      text-align: right;
    }

    th {
      background-color: #f2f2f2;
    }

    h2 {
      background-color: #e0e0e0;
      padding: 10px;
    }

    button {
      padding: 10px 20px;
      font-size: 16px;
      margin-top: 20px;
    }

    canvas#signature {
      border: 2px solid black;
    }
  </style>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/pako/2.0.4/pako.min.js"></script>
  <!-- Pako from CDN -->
</head>

<body>
  <h2>חוות דעת המפקד הישיר</h2>
  <form id="feedback-form">
    <fieldset>
      <label>תאריך:</label>
      <input type="date" name="date">

      <label>שם פרטי:</label>
      <input type="text" name="firstName">

      <label>מספר אישי (7 ספרות):</label>
      <input type="text" name="personalNumber" pattern="\d{7}">

      <label>החייל משרת תחת פיקודי (בחודשים):</label>
      <input type="number" name="monthsUnder" min="0">

      <label>מידת היכרות עם החייל:</label>
      <select name="familiarity">
        <option value="">בחר</option>
        <option>טובה מאוד</option>
        <option>די טובה</option>
        <option>בינונית</option>
        <option>קלושה</option>
      </select>

      <label>תפקיד נוכחי של החייל\ת:</label>
      <input type="text" name="role">

      <label>מאפייני החייל - טבלה:</label>
      <table>
        <thead>
          <tr>
            <th>מאפייני החייל</th>
            <th>הסבר / דוגמה</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td><input type="text" name="feature1" placeholder="נקודת חוזק 1"></td>
            <td><input type="text" name="example1"></td>
          </tr>
          <tr>
            <td><input type="text" name="feature2" placeholder="נקודת חוזק 2"></td>
            <td><input type="text" name="example2"></td>
          </tr>
          <tr>
            <td><input type="text" name="feature3" placeholder="נקודת חולשה 1"></td>
            <td><input type="text" name="example3"></td>
          </tr>
          <tr>
            <td><input type="text" name="feature4" placeholder="נקודת חולשה 2"></td>
            <td><input type="text" name="example4"></td>
          </tr>
        </tbody>
      </table>

      <label>מה מידת המוטיבציה של החייל לצאת לקצונה:</label>
      <select name="motivation">
        <option value="">בחר</option>
        <option>גבוהה מאוד</option>
        <option>גבוהה</option>
        <option>בינונית</option>
        <option>נמוכה</option>
        <option>איני רוצה לצאת</option>
      </select>

      <label>תחומים בהם החייל עלול להתקשות בקורס קצינים / בתפקיד:</label>
      <textarea name="difficultyAreas" rows="3"></textarea>

      <label>עד כמה מתאים/ה החייל/ת לקצונה ביחס לחיילים אחרים בתפקידים דומים?</label>
      <select name="suitabilityCompared">
        <option value="">בחר</option>
        <option>יותר מרוב החיילים</option>
        <option>כמו רוב החיילים</option>
        <option>פחות מרוב החיילים</option>
        <option>אינו מתאים כלל</option>
      </select>

      <label>עד כמה תהיה מוכן לקבל את החייל/ת תחת פיקודך כקצין/ה?</label>
      <select name="willingnessCommand">
        <option value="">בחר</option>
        <option>במידה רבה מאוד</option>
        <option>במידה רבה</option>
        <option>במידה בינונית</option>
        <option>במידה מועטה</option>
        <option>לא מעוניין כלל</option>
      </select>

      <h3>פרטי המפקד:</h3>
      <label>שם פרטי:</label>
      <input type="text" name="commanderName">

      <label>טלפון:</label>
      <input type="text" name="commanderPhone" pattern="\d{10}">

      <label>משוב לחוות הדעת - שם פרטי:</label>
      <input type="text" name="feedbackName">

      <input type="hidden" name="signature" />
      <canvas id="signature" width="400" height="150" style="border:1px solid #ccc;"></canvas>

      <button type="button" onclick="clearSignature()">נקה חתימה</button>

      <h2>חוות דעת מפקדו של המפקד הישיר</h2>
      <!-- Trait Table -->
      <table>
        <thead>
          <tr>
            <th>מאפיין</th>
            <th>דירוג</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>עצמאות בביצוע משימות</td>
            <td>
              <select name="rating_0" required>
                <option value="">בחר</option>
                <option>לא ניתן להעריך</option>
                <option>נמוך מאוד</option>
                <option>נמוך</option>
                <option>בינוני</option>
                <option>גבוה</option>
                <option>גבוה מאוד</option>
              </select>
            </td>
          </tr>
          <tr>
            <td>תפקוד יעיל בלחץ ובעומס</td>
            <td>
              <select name="rating_1" required>
                <option value="">בחר</option>
                <option>לא ניתן להעריך</option>
                <option>נמוך מאוד</option>
                <option>נמוך</option>
                <option>בינוני</option>
                <option>גבוה</option>
                <option>גבוה מאוד</option>
              </select>
            </td>
          </tr>
          <tr>
            <td>קבלת החלטות</td>
            <td>
              <select name="rating_2" required>
                <option value="">בחר</option>
                <option>לא ניתן להעריך</option>
                <option>נמוך מאוד</option>
                <option>נמוך</option>
                <option>בינוני</option>
                <option>גבוה</option>
                <option>גבוה מאוד</option>
              </select>
            </td>
          </tr>
          <tr>
            <td>משמעת והסתגלות לצרכי המערכת</td>
            <td>
              <select name="rating_3" required>
                <option value="">בחר</option>
                <option>לא ניתן להעריך</option>
                <option>נמוך מאוד</option>
                <option>נמוך</option>
                <option>בינוני</option>
                <option>גבוה</option>
                <option>גבוה מאוד</option>
              </select>
            </td>
          </tr>
          <tr>
            <td>יכולת חשיבה ולמידה עצמית</td>
            <td>
              <select name="rating_4" required>
                <option value="">בחר</option>
                <option>לא ניתן להעריך</option>
                <option>נמוך מאוד</option>
                <option>נמוך</option>
                <option>בינוני</option>
                <option>גבוה</option>
                <option>גבוה מאוד</option>
              </select>
            </td>
          </tr>
          <tr>
            <td>עבודת צוות</td>
            <td>
              <select name="rating_5" required>
                <option value="">בחר</option>
                <option>לא ניתן להעריך</option>
                <option>נמוך מאוד</option>
                <option>נמוך</option>
                <option>בינוני</option>
                <option>גבוה</option>
                <option>גבוה מאוד</option>
              </select>
            </td>
          </tr>
          <tr>
            <td>אומץ איתנות וקור רוח (רק לקרביים)</td>
            <td>
              <select name="rating_6" required>
                <option value="">בחר</option>
                <option>לא ניתן להעריך</option>
                <option>נמוך מאוד</option>
                <option>נמוך</option>
                <option>בינוני</option>
                <option>גבוה</option>
                <option>גבוה מאוד</option>
              </select>
            </td>
          </tr>
          <tr>
            <td>אסרטיביות ויכולת הובלה</td>
            <td>
              <select name="rating_7" required>
                <option value="">בחר</option>
                <option>לא ניתן להעריך</option>
                <option>נמוך מאוד</option>
                <option>נמוך</option>
                <option>בינוני</option>
                <option>גבוה</option>
                <option>גבוה מאוד</option>
              </select>
            </td>
          </tr>
          <tr>
            <td>אחריות והשקעה בהתמדה</td>
            <td>
              <select name="rating_8" required>
                <option value="">בחר</option>
                <option>לא ניתן להעריך</option>
                <option>נמוך מאוד</option>
                <option>נמוך</option>
                <option>בינוני</option>
                <option>גבוה</option>
                <option>גבוה מאוד</option>
              </select>
            </td>
          </tr>
          <tr>
            <td>קבלת ביקורת</td>
            <td>
              <select name="rating_9" required>
                <option value="">בחר</option>
                <option>לא ניתן להעריך</option>
                <option>נמוך מאוד</option>
                <option>נמוך</option>
                <option>בינוני</option>
                <option>גבוה</option>
                <option>גבוה מאוד</option>
              </select>
            </td>
          </tr>
        </tbody>
      </table>


      <label>משך היכרותך עם החייל (בחודשים):</label>
      <input type="number" name="monthsUnder2" min="0">

      <label>מידת היכרות:</label>
      <select name="familiarity2">
        <option value="">בחר</option>
        <option>טובה מאוד</option>
        <option>די טובה</option>
        <option>בינונית</option>
        <option>קלושה</option>
        <option>איני יכול להעריך</option>
      </select>

      <label>נקודת חוזק:</label>
      <input type="text" name="strength2">

      <label>נקודת חולשה:</label>
      <input type="text" name="weakness2">

      <label>עד כמה תהיה מוכן שהחייל ישרת תחת פיקודך כקצין:</label>
      <select name="willingnessCommand2">
        <option value="">בחר</option>
        <option>במידה רבה מאוד</option>
        <option>במידה רבה</option>
        <option>במידה בינונית</option>
        <option>במידה מועטה</option>
        <option>לא מעוניין כלל</option>
      </select>

      <label>הערות נוספות:</label>
      <textarea name="additionalComments" rows="3"></textarea>

      <h3>פרטי מפקדו של המפקד הישיר:</h3>
      <label>שם פרטי בלבד:</label>
      <input type="text" name="commander2Name">

      <label>טלפון (10 ספרות):</label>
      <input type="text" name="commander2Phone" pattern="\d{10}">

      <button type="button" id="send-form">שלח במייל</button>
    </fieldset>
  </form>

  <script>

    // פונקציה לניקוי חתימה
    function clearSignature() {
      const canvas = document.getElementById("signature-pad");
      const ctx = canvas.getContext("2d");
      ctx.clearRect(0, 0, canvas.width, canvas.height);
    }

  </script>

  <script>


    var canvas = document.getElementById('signature');
    var ctx = canvas.getContext("2d");
    var drawing = false;
    var prevX, prevY;
    var currX, currY;
    var signature = document.getElementsByName('signature')[0];

    canvas.addEventListener("mousemove", draw);
    document.addEventListener("mouseup", stop);
    canvas.addEventListener("mousedown", start);

    // function blah(e) {
    //   setCanvasElFromHiddenInput()
    // }

    function setCanvasElFromHiddenInput(){
      const img = new Image()
      img.src=signature.value

      img.addEventListener("load", () => {
        canvas.getContext('2d').drawImage(img, 0, 0)
      })
    }


    function start(e) {

      console.log("starting to draw", signature.value[0], signature.value[1])
      drawing = true;
    }

    function stop() {

      if(drawing){

        console.log("stopping drawing")
        drawing = false;
        prevX = prevY = null;
        signature.value = canvas.toDataURL();

      }
    }

    function draw(e) {
      
      if (!drawing) {
        return;
      }

      console.log("well... drawing")

      // Test for touchmove event, this requires another property.
      var clientX = e.type === 'touchmove' ? e.touches[0].clientX : e.clientX;
      var clientY = e.type === 'touchmove' ? e.touches[0].clientY : e.clientY;

      console.log(clientX, clientY)

      currX = clientX - canvas.getBoundingClientRect().left;
      currY = clientY - canvas.getBoundingClientRect().top;

      // console.log(currX, currY)

      if (!prevX && !prevY) {
        prevX = currX;
        prevY = currY;
      }

      ctx.beginPath();
      ctx.moveTo(prevX, prevY);
      ctx.lineTo(currX, currY);
      ctx.strokeStyle = 'black';
      ctx.lineWidth = 2;
      ctx.stroke();
      ctx.closePath();

      prevX = currX;
      prevY = currY;
    }

    function clearSignature(e) {
      ctx = canvas.getContext('2d');
      ctx.clearRect(0, 0, canvas.width, canvas.height);

      signature.value = "";
    }

    // function onSubmit(e) {
    //     console.log({
    //         'name': document.getElementsByName('name')[0].value,
    //         'signature': signature.value,
    //     });
    //     return false;
    // }

  </script>



<script>
const htmlStart = "<" + "!DOCTYPE html> \n"
 + "<" + "html lang=\"he\" dir=\"rtl\"> \n"
 + " \n"
 + "<" + "head> \n"
 + "  <" + "meta charset=\"UTF-8\"> \n"
 + "  <" + "title>חוות דעת לקצונה<" + "/title> \n"
 + "  <" + "style> \n"
 + "    body { \n"
 + "      font-family: Arial, sans-serif; \n"
 + "      direction: rtl; \n"
 + "      padding: 20px; \n"
 + "    } \n"
 + " \n"
 + "    label { \n"
 + "      display: block; \n"
 + "      margin-top: 10px; \n"
 + "      font-weight: bold; \n"
 + "    } \n"
 + " \n"
 + "    input, \n"
 + "    select, \n"
 + "    textarea { \n"
 + "      width: 100%; \n"
 + "      margin-bottom: 10px; \n"
 + "      padding: 5px; \n"
 + "    } \n"
 + " \n"
 + "    table { \n"
 + "      width: 100%; \n"
 + "      border-collapse: collapse; \n"
 + "      margin-bottom: 20px; \n"
 + "    } \n"
 + " \n"
 + "    th, \n"
 + "    td { \n"
 + "      border: 1px solid #ccc; \n"
 + "      padding: 8px; \n"
 + "      text-align: right; \n"
 + "    } \n"
 + " \n"
 + "    th { \n"
 + "      background-color: #f2f2f2; \n"
 + "    } \n"
 + " \n"
 + "    h2 { \n"
 + "      background-color: #e0e0e0; \n"
 + "      padding: 10px; \n"
 + "    } \n"
 + " \n"
 + "    button { \n"
 + "      padding: 10px 20px; \n"
 + "      font-size: 16px; \n"
 + "      margin-top: 20px; \n"
 + "    } \n"
 + " \n"
 + "    canvas#signature { \n"
 + "      border: 2px solid black; \n"
 + "    } \n"
 + "  <" + "/style> \n"
 + " \n"
 + "  <" + "script src=\"https://cdnjs.cloudflare.com/ajax/libs/pako/2.0.4/pako.min.js\"><" + "/script> \n"
 + "  <" + "!-- Pako from CDN --> \n"
 + "<" + "/head> \n"
 + " \n"
 + "<" + "body> \n"
 + "  <" + "h2>חוות דעת המפקד הישיר<" + "/h2> \n"
 + "  <" + "form id=\"feedback-form\"> \n"
 + "    <" + "fieldset> \n"
 + "      <" + "label>תאריך:<" + "/label> \n"
 + "      <" + "input type=\"date\" name=\"date\"> \n"
 + " \n"
 + "      <" + "label>שם פרטי:<" + "/label> \n"
 + "      <" + "input type=\"text\" name=\"firstName\"> \n"
 + " \n"
 + "      <" + "label>מספר אישי (7 ספרות):<" + "/label> \n"
 + "      <" + "input type=\"text\" name=\"personalNumber\" pattern=\"\d{7}\"> \n"
 + " \n"
 + "      <" + "label>החייל משרת תחת פיקודי (בחודשים):<" + "/label> \n"
 + "      <" + "input type=\"number\" name=\"monthsUnder\" min=\"0\"> \n"
 + " \n"
 + "      <" + "label>מידת היכרות עם החייל:<" + "/label> \n"
 + "      <" + "select name=\"familiarity\"> \n"
 + "        <" + "option value=\"\">בחר<" + "/option> \n"
 + "        <" + "option>טובה מאוד<" + "/option> \n"
 + "        <" + "option>די טובה<" + "/option> \n"
 + "        <" + "option>בינונית<" + "/option> \n"
 + "        <" + "option>קלושה<" + "/option> \n"
 + "      <" + "/select> \n"
 + " \n"
 + "      <" + "label>תפקיד נוכחי של החייל\ת:<" + "/label> \n"
 + "      <" + "input type=\"text\" name=\"role\"> \n"
 + " \n"
 + "      <" + "label>מאפייני החייל - טבלה:<" + "/label> \n"
 + "      <" + "table> \n"
 + "        <" + "thead> \n"
 + "          <" + "tr> \n"
 + "            <" + "th>מאפייני החייל<" + "/th> \n"
 + "            <" + "th>הסבר / דוגמה<" + "/th> \n"
 + "          <" + "/tr> \n"
 + "        <" + "/thead> \n"
 + "        <" + "tbody> \n"
 + "          <" + "tr> \n"
 + "            <" + "td><" + "input type=\"text\" name=\"feature1\" placeholder=\"נקודת חוזק 1\"><" + "/td> \n"
 + "            <" + "td><" + "input type=\"text\" name=\"example1\"><" + "/td> \n"
 + "          <" + "/tr> \n"
 + "          <" + "tr> \n"
 + "            <" + "td><" + "input type=\"text\" name=\"feature2\" placeholder=\"נקודת חוזק 2\"><" + "/td> \n"
 + "            <" + "td><" + "input type=\"text\" name=\"example2\"><" + "/td> \n"
 + "          <" + "/tr> \n"
 + "          <" + "tr> \n"
 + "            <" + "td><" + "input type=\"text\" name=\"feature3\" placeholder=\"נקודת חולשה 1\"><" + "/td> \n"
 + "            <" + "td><" + "input type=\"text\" name=\"example3\"><" + "/td> \n"
 + "          <" + "/tr> \n"
 + "          <" + "tr> \n"
 + "            <" + "td><" + "input type=\"text\" name=\"feature4\" placeholder=\"נקודת חולשה 2\"><" + "/td> \n"
 + "            <" + "td><" + "input type=\"text\" name=\"example4\"><" + "/td> \n"
 + "          <" + "/tr> \n"
 + "        <" + "/tbody> \n"
 + "      <" + "/table> \n"
 + " \n"
 + "      <" + "label>מה מידת המוטיבציה של החייל לצאת לקצונה:<" + "/label> \n"
 + "      <" + "select name=\"motivation\"> \n"
 + "        <" + "option value=\"\">בחר<" + "/option> \n"
 + "        <" + "option>גבוהה מאוד<" + "/option> \n"
 + "        <" + "option>גבוהה<" + "/option> \n"
 + "        <" + "option>בינונית<" + "/option> \n"
 + "        <" + "option>נמוכה<" + "/option> \n"
 + "        <" + "option>איני רוצה לצאת<" + "/option> \n"
 + "      <" + "/select> \n"
 + " \n"
 + "      <" + "label>תחומים בהם החייל עלול להתקשות בקורס קצינים / בתפקיד:<" + "/label> \n"
 + "      <" + "textarea name=\"difficultyAreas\" rows=\"3\"><" + "/textarea> \n"
 + " \n"
 + "      <" + "label>עד כמה מתאים/ה החייל/ת לקצונה ביחס לחיילים אחרים בתפקידים דומים?<" + "/label> \n"
 + "      <" + "select name=\"suitabilityCompared\"> \n"
 + "        <" + "option value=\"\">בחר<" + "/option> \n"
 + "        <" + "option>יותר מרוב החיילים<" + "/option> \n"
 + "        <" + "option>כמו רוב החיילים<" + "/option> \n"
 + "        <" + "option>פחות מרוב החיילים<" + "/option> \n"
 + "        <" + "option>אינו מתאים כלל<" + "/option> \n"
 + "      <" + "/select> \n"
 + " \n"
 + "      <" + "label>עד כמה תהיה מוכן לקבל את החייל/ת תחת פיקודך כקצין/ה?<" + "/label> \n"
 + "      <" + "select name=\"willingnessCommand\"> \n"
 + "        <" + "option value=\"\">בחר<" + "/option> \n"
 + "        <" + "option>במידה רבה מאוד<" + "/option> \n"
 + "        <" + "option>במידה רבה<" + "/option> \n"
 + "        <" + "option>במידה בינונית<" + "/option> \n"
 + "        <" + "option>במידה מועטה<" + "/option> \n"
 + "        <" + "option>לא מעוניין כלל<" + "/option> \n"
 + "      <" + "/select> \n"
 + " \n"
 + "      <" + "h3>פרטי המפקד:<" + "/h3> \n"
 + "      <" + "label>שם פרטי:<" + "/label> \n"
 + "      <" + "input type=\"text\" name=\"commanderName\"> \n"
 + " \n"
 + "      <" + "label>טלפון:<" + "/label> \n"
 + "      <" + "input type=\"text\" name=\"commanderPhone\" pattern=\"\d{10}\"> \n"
 + " \n"
 + "      <" + "label>משוב לחוות הדעת - שם פרטי:<" + "/label> \n"
 + "      <" + "input type=\"text\" name=\"feedbackName\"> \n"
 + " \n"
 + "      <" + "input type=\"hidden\" name=\"signature\" /> \n"
 + "      <" + "canvas id=\"signature\" width=\"400\" height=\"150\" style=\"border:1px solid #ccc;\"><" + "/canvas> \n"
 + " \n"
 + "      <" + "button type=\"button\" onclick=\"clearSignature()\">נקה חתימה<" + "/button> \n"
 + " \n"
 + "      <" + "h2>חוות דעת מפקדו של המפקד הישיר<" + "/h2> \n"
 + "      <" + "!-- Trait Table --> \n"
 + "      <" + "table> \n"
 + "        <" + "thead> \n"
 + "          <" + "tr> \n"
 + "            <" + "th>מאפיין<" + "/th> \n"
 + "            <" + "th>דירוג<" + "/th> \n"
 + "          <" + "/tr> \n"
 + "        <" + "/thead> \n"
 + "        <" + "tbody> \n"
 + "          <" + "tr> \n"
 + "            <" + "td>עצמאות בביצוע משימות<" + "/td> \n"
 + "            <" + "td> \n"
 + "              <" + "select name=\"rating_0\" required> \n"
 + "                <" + "option value=\"\">בחר<" + "/option> \n"
 + "                <" + "option>לא ניתן להעריך<" + "/option> \n"
 + "                <" + "option>נמוך מאוד<" + "/option> \n"
 + "                <" + "option>נמוך<" + "/option> \n"
 + "                <" + "option>בינוני<" + "/option> \n"
 + "                <" + "option>גבוה<" + "/option> \n"
 + "                <" + "option>גבוה מאוד<" + "/option> \n"
 + "              <" + "/select> \n"
 + "            <" + "/td> \n"
 + "          <" + "/tr> \n"
 + "          <" + "tr> \n"
 + "            <" + "td>תפקוד יעיל בלחץ ובעומס<" + "/td> \n"
 + "            <" + "td> \n"
 + "              <" + "select name=\"rating_1\" required> \n"
 + "                <" + "option value=\"\">בחר<" + "/option> \n"
 + "                <" + "option>לא ניתן להעריך<" + "/option> \n"
 + "                <" + "option>נמוך מאוד<" + "/option> \n"
 + "                <" + "option>נמוך<" + "/option> \n"
 + "                <" + "option>בינוני<" + "/option> \n"
 + "                <" + "option>גבוה<" + "/option> \n"
 + "                <" + "option>גבוה מאוד<" + "/option> \n"
 + "              <" + "/select> \n"
 + "            <" + "/td> \n"
 + "          <" + "/tr> \n"
 + "          <" + "tr> \n"
 + "            <" + "td>קבלת החלטות<" + "/td> \n"
 + "            <" + "td> \n"
 + "              <" + "select name=\"rating_2\" required> \n"
 + "                <" + "option value=\"\">בחר<" + "/option> \n"
 + "                <" + "option>לא ניתן להעריך<" + "/option> \n"
 + "                <" + "option>נמוך מאוד<" + "/option> \n"
 + "                <" + "option>נמוך<" + "/option> \n"
 + "                <" + "option>בינוני<" + "/option> \n"
 + "                <" + "option>גבוה<" + "/option> \n"
 + "                <" + "option>גבוה מאוד<" + "/option> \n"
 + "              <" + "/select> \n"
 + "            <" + "/td> \n"
 + "          <" + "/tr> \n"
 + "          <" + "tr> \n"
 + "            <" + "td>משמעת והסתגלות לצרכי המערכת<" + "/td> \n"
 + "            <" + "td> \n"
 + "              <" + "select name=\"rating_3\" required> \n"
 + "                <" + "option value=\"\">בחר<" + "/option> \n"
 + "                <" + "option>לא ניתן להעריך<" + "/option> \n"
 + "                <" + "option>נמוך מאוד<" + "/option> \n"
 + "                <" + "option>נמוך<" + "/option> \n"
 + "                <" + "option>בינוני<" + "/option> \n"
 + "                <" + "option>גבוה<" + "/option> \n"
 + "                <" + "option>גבוה מאוד<" + "/option> \n"
 + "              <" + "/select> \n"
 + "            <" + "/td> \n"
 + "          <" + "/tr> \n"
 + "          <" + "tr> \n"
 + "            <" + "td>יכולת חשיבה ולמידה עצמית<" + "/td> \n"
 + "            <" + "td> \n"
 + "              <" + "select name=\"rating_4\" required> \n"
 + "                <" + "option value=\"\">בחר<" + "/option> \n"
 + "                <" + "option>לא ניתן להעריך<" + "/option> \n"
 + "                <" + "option>נמוך מאוד<" + "/option> \n"
 + "                <" + "option>נמוך<" + "/option> \n"
 + "                <" + "option>בינוני<" + "/option> \n"
 + "                <" + "option>גבוה<" + "/option> \n"
 + "                <" + "option>גבוה מאוד<" + "/option> \n"
 + "              <" + "/select> \n"
 + "            <" + "/td> \n"
 + "          <" + "/tr> \n"
 + "          <" + "tr> \n"
 + "            <" + "td>עבודת צוות<" + "/td> \n"
 + "            <" + "td> \n"
 + "              <" + "select name=\"rating_5\" required> \n"
 + "                <" + "option value=\"\">בחר<" + "/option> \n"
 + "                <" + "option>לא ניתן להעריך<" + "/option> \n"
 + "                <" + "option>נמוך מאוד<" + "/option> \n"
 + "                <" + "option>נמוך<" + "/option> \n"
 + "                <" + "option>בינוני<" + "/option> \n"
 + "                <" + "option>גבוה<" + "/option> \n"
 + "                <" + "option>גבוה מאוד<" + "/option> \n"
 + "              <" + "/select> \n"
 + "            <" + "/td> \n"
 + "          <" + "/tr> \n"
 + "          <" + "tr> \n"
 + "            <" + "td>אומץ איתנות וקור רוח (רק לקרביים)<" + "/td> \n"
 + "            <" + "td> \n"
 + "              <" + "select name=\"rating_6\" required> \n"
 + "                <" + "option value=\"\">בחר<" + "/option> \n"
 + "                <" + "option>לא ניתן להעריך<" + "/option> \n"
 + "                <" + "option>נמוך מאוד<" + "/option> \n"
 + "                <" + "option>נמוך<" + "/option> \n"
 + "                <" + "option>בינוני<" + "/option> \n"
 + "                <" + "option>גבוה<" + "/option> \n"
 + "                <" + "option>גבוה מאוד<" + "/option> \n"
 + "              <" + "/select> \n"
 + "            <" + "/td> \n"
 + "          <" + "/tr> \n"
 + "          <" + "tr> \n"
 + "            <" + "td>אסרטיביות ויכולת הובלה<" + "/td> \n"
 + "            <" + "td> \n"
 + "              <" + "select name=\"rating_7\" required> \n"
 + "                <" + "option value=\"\">בחר<" + "/option> \n"
 + "                <" + "option>לא ניתן להעריך<" + "/option> \n"
 + "                <" + "option>נמוך מאוד<" + "/option> \n"
 + "                <" + "option>נמוך<" + "/option> \n"
 + "                <" + "option>בינוני<" + "/option> \n"
 + "                <" + "option>גבוה<" + "/option> \n"
 + "                <" + "option>גבוה מאוד<" + "/option> \n"
 + "              <" + "/select> \n"
 + "            <" + "/td> \n"
 + "          <" + "/tr> \n"
 + "          <" + "tr> \n"
 + "            <" + "td>אחריות והשקעה בהתמדה<" + "/td> \n"
 + "            <" + "td> \n"
 + "              <" + "select name=\"rating_8\" required> \n"
 + "                <" + "option value=\"\">בחר<" + "/option> \n"
 + "                <" + "option>לא ניתן להעריך<" + "/option> \n"
 + "                <" + "option>נמוך מאוד<" + "/option> \n"
 + "                <" + "option>נמוך<" + "/option> \n"
 + "                <" + "option>בינוני<" + "/option> \n"
 + "                <" + "option>גבוה<" + "/option> \n"
 + "                <" + "option>גבוה מאוד<" + "/option> \n"
 + "              <" + "/select> \n"
 + "            <" + "/td> \n"
 + "          <" + "/tr> \n"
 + "          <" + "tr> \n"
 + "            <" + "td>קבלת ביקורת<" + "/td> \n"
 + "            <" + "td> \n"
 + "              <" + "select name=\"rating_9\" required> \n"
 + "                <" + "option value=\"\">בחר<" + "/option> \n"
 + "                <" + "option>לא ניתן להעריך<" + "/option> \n"
 + "                <" + "option>נמוך מאוד<" + "/option> \n"
 + "                <" + "option>נמוך<" + "/option> \n"
 + "                <" + "option>בינוני<" + "/option> \n"
 + "                <" + "option>גבוה<" + "/option> \n"
 + "                <" + "option>גבוה מאוד<" + "/option> \n"
 + "              <" + "/select> \n"
 + "            <" + "/td> \n"
 + "          <" + "/tr> \n"
 + "        <" + "/tbody> \n"
 + "      <" + "/table> \n"
 + " \n"
 + " \n"
 + "      <" + "label>משך היכרותך עם החייל (בחודשים):<" + "/label> \n"
 + "      <" + "input type=\"number\" name=\"monthsUnder2\" min=\"0\"> \n"
 + " \n"
 + "      <" + "label>מידת היכרות:<" + "/label> \n"
 + "      <" + "select name=\"familiarity2\"> \n"
 + "        <" + "option value=\"\">בחר<" + "/option> \n"
 + "        <" + "option>טובה מאוד<" + "/option> \n"
 + "        <" + "option>די טובה<" + "/option> \n"
 + "        <" + "option>בינונית<" + "/option> \n"
 + "        <" + "option>קלושה<" + "/option> \n"
 + "        <" + "option>איני יכול להעריך<" + "/option> \n"
 + "      <" + "/select> \n"
 + " \n"
 + "      <" + "label>נקודת חוזק:<" + "/label> \n"
 + "      <" + "input type=\"text\" name=\"strength2\"> \n"
 + " \n"
 + "      <" + "label>נקודת חולשה:<" + "/label> \n"
 + "      <" + "input type=\"text\" name=\"weakness2\"> \n"
 + " \n"
 + "      <" + "label>עד כמה תהיה מוכן שהחייל ישרת תחת פיקודך כקצין:<" + "/label> \n"
 + "      <" + "select name=\"willingnessCommand2\"> \n"
 + "        <" + "option value=\"\">בחר<" + "/option> \n"
 + "        <" + "option>במידה רבה מאוד<" + "/option> \n"
 + "        <" + "option>במידה רבה<" + "/option> \n"
 + "        <" + "option>במידה בינונית<" + "/option> \n"
 + "        <" + "option>במידה מועטה<" + "/option> \n"
 + "        <" + "option>לא מעוניין כלל<" + "/option> \n"
 + "      <" + "/select> \n"
 + " \n"
 + "      <" + "label>הערות נוספות:<" + "/label> \n"
 + "      <" + "textarea name=\"additionalComments\" rows=\"3\"><" + "/textarea> \n"
 + " \n"
 + "      <" + "h3>פרטי מפקדו של המפקד הישיר:<" + "/h3> \n"
 + "      <" + "label>שם פרטי בלבד:<" + "/label> \n"
 + "      <" + "input type=\"text\" name=\"commander2Name\"> \n"
 + " \n"
 + "      <" + "label>טלפון (10 ספרות):<" + "/label> \n"
 + "      <" + "input type=\"text\" name=\"commander2Phone\" pattern=\"\d{10}\"> \n"
 + " \n"
 + "      <" + "button type=\"button\" id=\"send-form\">שלח במייל<" + "/button> \n"
 + "    <" + "/fieldset> \n"
 + "  <" + "/form> \n"
 + " \n"
 + "  <" + "script> \n"
 + " \n"
 + "    // פונקציה לניקוי חתימה \n"
 + "    function clearSignature() { \n"
 + "      const canvas = document.getElementById(\"signature-pad\"); \n"
 + "      const ctx = canvas.getContext(\"2d\"); \n"
 + "      ctx.clearRect(0, 0, canvas.width, canvas.height); \n"
 + "    } \n"
 + " \n"
 + "  <" + "/script> \n"
 + " \n"
 + "  <" + "script> \n"
 + " \n"
 + " \n"
 + "    var canvas = document.getElementById('signature'); \n"
 + "    var ctx = canvas.getContext(\"2d\"); \n"
 + "    var drawing = false; \n"
 + "    var prevX, prevY; \n"
 + "    var currX, currY; \n"
 + "    var signature = document.getElementsByName('signature')[0]; \n"
 + " \n"
 + "    canvas.addEventListener(\"mousemove\", draw); \n"
 + "    document.addEventListener(\"mouseup\", stop); \n"
 + "    canvas.addEventListener(\"mousedown\", start); \n"
 + " \n"
 + "    // function blah(e) { \n"
 + "    //   setCanvasElFromHiddenInput() \n"
 + "    // } \n"
 + " \n"
 + "    function setCanvasElFromHiddenInput(){ \n"
 + "      const img = new Image() \n"
 + "      img.src=signature.value \n"
 + " \n"
 + "      img.addEventListener(\"load\", () => { \n"
 + "        canvas.getContext('2d').drawImage(img, 0, 0) \n"
 + "      }) \n"
 + "    } \n"
 + " \n"
 + " \n"
 + "    function start(e) { \n"
 + " \n"
 + "      console.log(\"starting to draw\", signature.value[0], signature.value[1]) \n"
 + "      drawing = true; \n"
 + "    } \n"
 + " \n"
 + "    function stop() { \n"
 + " \n"
 + "      if(drawing){ \n"
 + " \n"
 + "        console.log(\"stopping drawing\") \n"
 + "        drawing = false; \n"
 + "        prevX = prevY = null; \n"
 + "        signature.value = canvas.toDataURL(); \n"
 + " \n"
 + "      } \n"
 + "    } \n"
 + " \n"
 + "    function draw(e) { \n"
 + "       \n"
 + "      if (!drawing) { \n"
 + "        return; \n"
 + "      } \n"
 + " \n"
 + "      console.log(\"well... drawing\") \n"
 + " \n"
 + "      // Test for touchmove event, this requires another property. \n"
 + "      var clientX = e.type === 'touchmove' ? e.touches[0].clientX : e.clientX; \n"
 + "      var clientY = e.type === 'touchmove' ? e.touches[0].clientY : e.clientY; \n"
 + " \n"
 + "      console.log(clientX, clientY) \n"
 + " \n"
 + "      currX = clientX - canvas.getBoundingClientRect().left; \n"
 + "      currY = clientY - canvas.getBoundingClientRect().top; \n"
 + " \n"
 + "      // console.log(currX, currY) \n"
 + " \n"
 + "      if (!prevX && !prevY) { \n"
 + "        prevX = currX; \n"
 + "        prevY = currY; \n"
 + "      } \n"
 + " \n"
 + "      ctx.beginPath(); \n"
 + "      ctx.moveTo(prevX, prevY); \n"
 + "      ctx.lineTo(currX, currY); \n"
 + "      ctx.strokeStyle = 'black'; \n"
 + "      ctx.lineWidth = 2; \n"
 + "      ctx.stroke(); \n"
 + "      ctx.closePath(); \n"
 + " \n"
 + "      prevX = currX; \n"
 + "      prevY = currY; \n"
 + "    } \n"
 + " \n"
 + "    function clearSignature(e) { \n"
 + "      ctx = canvas.getContext('2d'); \n"
 + "      ctx.clearRect(0, 0, canvas.width, canvas.height); \n"
 + " \n"
 + "      signature.value = \"\"; \n"
 + "    } \n"
 + " \n"
 + "    // function onSubmit(e) { \n"
 + "    //     console.log({ \n"
 + "    //         'name': document.getElementsByName('name')[0].value, \n"
 + "    //         'signature': signature.value, \n"
 + "    //     }); \n"
 + "    //     return false; \n"
 + "    // } \n"
 + " \n"
 + "  <" + "/script> \n"
 + " \n"
 + " \n"
;const htmlEnd = "<" + "/body> \n"
 + " \n"
 + "<" + "/html> \n"
;
// שליחת הטופס במייל
function submitAndEmail(e) {

    alert("siuuu")

    // e.preventDefault()

    const form = document.getElementById('feedback-form');
    if (!form.checkValidity()) {
        form.reportValidity();
        return;
    }
    const formData = new FormData(form);
    script_str = ""

    for (const [name, val] of formData.entries()) {
        script_str += ("document.getElementsByName('" + name + "')[0].value = '" + val + "';\n")
    }

    htmlFile = htmlStart
        + "\n<" + "script>\n"
        + script_str
        + "\ndocument.querySelector('fieldset').disabled = true;\n "
        + "\ndocument.getElementById('send-form').style.display = 'none';\n "
        + "\nsetCanvasElFromHiddenInput()\n;"
        + "\ncanvas.style.pointerEvents='none' \n"
        + "\n<" + "/script>\n"
        + htmlEnd

    // console.log("htmlFile: " + htmlFile)

    const blob = new Blob([htmlFile], { type: 'text/plain' });
    const a = document.createElement('a');
    a.href = URL.createObjectURL(blob);
    a.download = 'form_data.html';
    a.click();
    URL.revokeObjectURL(a.href);

}

document.getElementById("send-form").addEventListener("click", submitAndEmail)
</script>
</body>

</html>
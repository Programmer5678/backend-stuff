<!DOCTYPE html>
<html lang="he" dir="rtl">

<head>
  <meta charset="UTF-8">
  <title>חוות דעת לקצונה</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      direction: rtl;
      padding: 20px;
    }

    label {
      display: block;
      margin-top: 10px;
      font-weight: bold;
    }

    input,
    select,
    textarea {
      width: 100%;
      margin-bottom: 10px;
      padding: 5px;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      margin-bottom: 20px;
    }

    th,
    td {
      border: 1px solid #ccc;
      padding: 8px;
      text-align: right;
    }

    th {
      background-color: #f2f2f2;
    }

    h2 {
      background-color: #e0e0e0;
      padding: 10px;
    }

    button {
      padding: 10px 20px;
      font-size: 16px;
      margin-top: 20px;
    }

    canvas#signature {
      border: 2px solid black;
    }


    .eval-table {
      border-collapse: collapse;
      direction: rtl;
      text-align: center;
      margin: 20px 0;
    }

    .eval-table th,
    .eval-table td {
      border: 1px solid #999;
      padding: 10px;
      min-width: 80px;
    }

    .eval-cell {
      cursor: pointer;
    }

    .eval-cell.selected {
      background-color: #d0f0d0;
      font-weight: bold;
    }

    .eval-feature {
      background-color: #f0f0f0;
      font-weight: bold;
    }
  </style>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/pako/2.0.4/pako.min.js"></script>
  <!-- Pako from CDN -->
</head>

<body>
  <form id="feedback-form">

    <fieldset>

      <label>תאריך:</label>
      <input type="date" name="date">

      <label>קוד סמכות: </label>
      <input type="number" name="samkhut">

      <label>מיועד לקורס: להב/מעוז/נחשון</label>

      <h1>חוות דעת של מועמד/ת לקורס קצונה</h1>

      <span>פרטי המועמד/ת</span>

      <label>שם פרטי בלבד:</label>
      <input type="text" name="firstName">

      <label>מ"א:</label>
      <input type="text" name="personalNumber" pattern="\d{7}">

      <h2>חלק א: חוות דעת המפקד הישיר</h2>

      <label>החייל משרת תחת פיקודי :
        <input type="number" name="monthsUnder" min="0">
        <span>חודשים </span>
      </label>

      <label>החו"ד נכתב יחד עם מפקד קודם:
        <input>
        <span>(סמן אם כן) </span>
      </label>

      <label>מידת היכרות עם החייל:</label>
      <select name="familiarity">
        <option value="">בחר</option>
        <option>טובה מאוד</option>
        <option>די טובה</option>
        <option>בינונית</option>
        <option>קלושה</option>
      </select>

      <label>תפקיד נוכחי של החייל\ת (פירוט ברמת בלמ"ס בלבד):</label>
      <input type="text" name="role">

      <label>תאר את המועמד/ת בטבלה הבאה, תוך התייחסות ל-2 נקודות חוזק ו-2 נקודות חולשה וכיצד הן באות לידי ביטוי על ידי
        הסבר או דוגמה.</label>
      <table class="eval-table" id="eval-table">
        <thead>
          <tr>
            <th>מאפיין</th>
            <th>גבוה מאוד</th>
            <th>גבוה</th>
            <th>בינוני</th>
            <th>נמוך</th>
            <th>נמוך מאוד</th>
            <th>לא ניתן להעריך</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td class="eval-feature">עצמאות בביצוע משימות</td>
            <td class="eval-cell" data-row="0" data-value="גבוה מאוד"></td>
            <td class="eval-cell" data-row="0" data-value="גבוה"></td>
            <td class="eval-cell" data-row="0" data-value="בינוני"></td>
            <td class="eval-cell" data-row="0" data-value="נמוך"></td>
            <td class="eval-cell" data-row="0" data-value="נמוך מאוד"></td>
            <td class="eval-cell" data-row="0" data-value="לא ניתן להעריך"></td>
            <td style="display:none;">
              <select name="rating_0" id="hidden-input-0" hidden>
                <option value=""></option>
                <option value="גבוה מאוד"></option>
                <option value="גבוה"></option>
                <option value="בינוני"></option>
                <option value="נמוך"></option>
                <option value="נמוך מאוד"></option>
                <option value="לא ניתן להעריך"></option>
              </select>
            </td>
          </tr>

          <tr>
            <td class="eval-feature">תפקוד יעיל בלחץ ובעומס</td>
            <td class="eval-cell" data-row="1" data-value="גבוה מאוד"></td>
            <td class="eval-cell" data-row="1" data-value="גבוה"></td>
            <td class="eval-cell" data-row="1" data-value="בינוני"></td>
            <td class="eval-cell" data-row="1" data-value="נמוך"></td>
            <td class="eval-cell" data-row="1" data-value="נמוך מאוד"></td>
            <td class="eval-cell" data-row="1" data-value="לא ניתן להעריך"></td>
            <td style="display:none;">
              <select name="rating_1" id="hidden-input-1" hidden>
                <option value=""></option>
                <option value="גבוה מאוד"></option>
                <option value="גבוה"></option>
                <option value="בינוני"></option>
                <option value="נמוך"></option>
                <option value="נמוך מאוד"></option>
                <option value="לא ניתן להעריך"></option>
              </select>
            </td>
          </tr>

          <tr>
            <td class="eval-feature">קבלת החלטות</td>
            <td class="eval-cell" data-row="2" data-value="גבוה מאוד"></td>
            <td class="eval-cell" data-row="2" data-value="גבוה"></td>
            <td class="eval-cell" data-row="2" data-value="בינוני"></td>
            <td class="eval-cell" data-row="2" data-value="נמוך"></td>
            <td class="eval-cell" data-row="2" data-value="נמוך מאוד"></td>
            <td class="eval-cell" data-row="2" data-value="לא ניתן להעריך"></td>
            <td style="display:none;">
              <select name="rating_2" id="hidden-input-2" hidden>
                <option value=""></option>
                <option value="גבוה מאוד"></option>
                <option value="גבוה"></option>
                <option value="בינוני"></option>
                <option value="נמוך"></option>
                <option value="נמוך מאוד"></option>
                <option value="לא ניתן להעריך"></option>
              </select>
            </td>
          </tr>

          <tr>
            <td class="eval-feature">משמעת והסתגלות לצרכי המערכת</td>
            <td class="eval-cell" data-row="3" data-value="גבוה מאוד"></td>
            <td class="eval-cell" data-row="3" data-value="גבוה"></td>
            <td class="eval-cell" data-row="3" data-value="בינוני"></td>
            <td class="eval-cell" data-row="3" data-value="נמוך"></td>
            <td class="eval-cell" data-row="3" data-value="נמוך מאוד"></td>
            <td class="eval-cell" data-row="3" data-value="לא ניתן להעריך"></td>
            <td style="display:none;">
              <select name="rating_3" id="hidden-input-3" hidden>
                <option value=""></option>
                <option value="גבוה מאוד"></option>
                <option value="גבוה"></option>
                <option value="בינוני"></option>
                <option value="נמוך"></option>
                <option value="נמוך מאוד"></option>
                <option value="לא ניתן להעריך"></option>
              </select>
            </td>
          </tr>

          <tr>
            <td class="eval-feature">יכולת חשיבה ולמידה עצמית</td>
            <td class="eval-cell" data-row="4" data-value="גבוה מאוד"></td>
            <td class="eval-cell" data-row="4" data-value="גבוה"></td>
            <td class="eval-cell" data-row="4" data-value="בינוני"></td>
            <td class="eval-cell" data-row="4" data-value="נמוך"></td>
            <td class="eval-cell" data-row="4" data-value="נמוך מאוד"></td>
            <td class="eval-cell" data-row="4" data-value="לא ניתן להעריך"></td>
            <td style="display:none;">
              <select name="rating_4" id="hidden-input-4" hidden>
                <option value=""></option>
                <option value="גבוה מאוד"></option>
                <option value="גבוה"></option>
                <option value="בינוני"></option>
                <option value="נמוך"></option>
                <option value="נמוך מאוד"></option>
                <option value="לא ניתן להעריך"></option>
              </select>
            </td>
          </tr>

          <tr>
            <td class="eval-feature">עבודת צוות</td>
            <td class="eval-cell" data-row="5" data-value="גבוה מאוד"></td>
            <td class="eval-cell" data-row="5" data-value="גבוה"></td>
            <td class="eval-cell" data-row="5" data-value="בינוני"></td>
            <td class="eval-cell" data-row="5" data-value="נמוך"></td>
            <td class="eval-cell" data-row="5" data-value="נמוך מאוד"></td>
            <td class="eval-cell" data-row="5" data-value="לא ניתן להעריך"></td>
            <td style="display:none;">
              <select name="rating_5" id="hidden-input-5" hidden>
                <option value=""></option>
                <option value="גבוה מאוד"></option>
                <option value="גבוה"></option>
                <option value="בינוני"></option>
                <option value="נמוך"></option>
                <option value="נמוך מאוד"></option>
                <option value="לא ניתן להעריך"></option>
              </select>
            </td>
          </tr>

          <tr>
            <td class="eval-feature">אסרטיביות ויכולת הובלה</td>
            <td class="eval-cell" data-row="6" data-value="גבוה מאוד"></td>
            <td class="eval-cell" data-row="6" data-value="גבוה"></td>
            <td class="eval-cell" data-row="6" data-value="בינוני"></td>
            <td class="eval-cell" data-row="6" data-value="נמוך"></td>
            <td class="eval-cell" data-row="6" data-value="נמוך מאוד"></td>
            <td class="eval-cell" data-row="6" data-value="לא ניתן להעריך"></td>
            <td style="display:none;">
              <select name="rating_6" id="hidden-input-6" hidden>
                <option value=""></option>
                <option value="גבוה מאוד"></option>
                <option value="גבוה"></option>
                <option value="בינוני"></option>
                <option value="נמוך"></option>
                <option value="נמוך מאוד"></option>
                <option value="לא ניתן להעריך"></option>
              </select>
            </td>
          </tr>
        </tbody>
      </table>


      <label>מה מידת המוטיבציה של החייל לצאת לקצונה:</label>
      <select name="motivation">
        <option value="">בחר</option>
        <option>גבוהה מאוד</option>
        <option>גבוהה</option>
        <option>בינונית</option>
        <option>נמוכה</option>
        <option>איני רוצה לצאת</option>
      </select>

      <label>תחומים בהם החייל עלול להתקשות בקורס קצינים / בתפקיד:</label>
      <textarea name="difficultyAreas" rows="3"></textarea>

      <label>עד כמה מתאים/ה החייל/ת לקצונה ביחס לחיילים אחרים בתפקידים דומים?</label>
      <select name="suitabilityCompared">
        <option value="">בחר</option>
        <option>יותר מרוב החיילים</option>
        <option>כמו רוב החיילים</option>
        <option>פחות מרוב החיילים</option>
        <option>אינו מתאים כלל</option>
      </select>

      <label>עד כמה תהיה מוכן לקבל את החייל/ת תחת פיקודך כקצין/ה?</label>
      <select name="willingnessCommand">
        <option value="">בחר</option>
        <option>במידה רבה מאוד</option>
        <option>במידה רבה</option>
        <option>במידה בינונית</option>
        <option>במידה מועטה</option>
        <option>לא מעוניין כלל</option>
      </select>

      <h3>פרטי המפקד:</h3>
      <label>שם פרטי:</label>
      <input type="text" name="commanderName">

      <label>טלפון:</label>
      <input type="text" name="commanderPhone" pattern="\d{10}">

      <label>משוב לחוות הדעת - שם פרטי:</label>
      <input type="text" name="feedbackName">

      <input type="hidden" name="signature" />
      <canvas id="signature" width="400" height="150" style="border:1px solid #ccc;"></canvas>

      <button type="button" onclick="clearSignature()">נקה חתימה</button>

      <h2>חוות דעת מפקדו של המפקד הישיר</h2>

      <label>משך היכרותך עם החייל (בחודשים):</label>
      <input type="number" name="monthsUnder2" min="0">

      <label>מידת היכרות:</label>
      <select name="familiarity2">
        <option value="">בחר</option>
        <option>טובה מאוד</option>
        <option>די טובה</option>
        <option>בינונית</option>
        <option>קלושה</option>
        <option>איני יכול להעריך</option>
      </select>

      <label>נקודת חוזק:</label>
      <input type="text" name="strength2">

      <label>נקודת חולשה:</label>
      <input type="text" name="weakness2">

      <label>עד כמה תהיה מוכן שהחייל ישרת תחת פיקודך כקצין:</label>
      <select name="willingnessCommand2">
        <option value="">בחר</option>
        <option>במידה רבה מאוד</option>
        <option>במידה רבה</option>
        <option>במידה בינונית</option>
        <option>במידה מועטה</option>
        <option>לא מעוניין כלל</option>
      </select>

      <label>הערות נוספות:</label>
      <textarea name="additionalComments" rows="3"></textarea>

      <h3>פרטי מפקדו של המפקד הישיר:</h3>
      <label>שם פרטי בלבד:</label>
      <input type="text" name="commander2Name">

      <label>טלפון (10 ספרות):</label>
      <input type="text" name="commander2Phone" pattern="\d{10}">

      <button type="button" id="send-form">שלח במייל</button>
    </fieldset>

  </form>

  <!-- <button id="tsup">Tsup</button>
  <button id="tsup2">Tsup2</button> -->


  <script>

    // פונקציה לניקוי חתימה
    function clearSignature() {
      const canvas = document.getElementById("signature-pad");
      const ctx = canvas.getContext("2d");
      ctx.clearRect(0, 0, canvas.width, canvas.height);
    }

  </script>

  <script>


    var canvas = document.getElementById('signature');
    var ctx = canvas.getContext("2d");
    var drawing = false;
    var prevX, prevY;
    var currX, currY;
    var signature = document.getElementsByName('signature')[0];

    canvas.addEventListener("mousemove", draw);
    document.addEventListener("mouseup", stop);
    canvas.addEventListener("mousedown", start);

    // function blah(e) {
    //   setCanvasElFromHiddenInput()
    // }

    function setCanvasElFromHiddenInput() {
      const img = new Image()
      img.src = signature.value

      img.addEventListener("load", () => {
        canvas.getContext('2d').drawImage(img, 0, 0)
      })
    }


    function start(e) {

      console.log("starting to draw", signature.value[0], signature.value[1])
      drawing = true;
    }

    function stop() {

      if (drawing) {

        console.log("stopping drawing")
        drawing = false;
        prevX = prevY = null;
        signature.value = canvas.toDataURL();

      }
    }

    function draw(e) {

      if (!drawing) {
        return;
      }

      console.log("well... drawing")

      // Test for touchmove event, this requires another property.
      var clientX = e.type === 'touchmove' ? e.touches[0].clientX : e.clientX;
      var clientY = e.type === 'touchmove' ? e.touches[0].clientY : e.clientY;

      console.log(clientX, clientY)

      currX = clientX - canvas.getBoundingClientRect().left;
      currY = clientY - canvas.getBoundingClientRect().top;

      // console.log(currX, currY)

      if (!prevX && !prevY) {
        prevX = currX;
        prevY = currY;
      }

      ctx.beginPath();
      ctx.moveTo(prevX, prevY);
      ctx.lineTo(currX, currY);
      ctx.strokeStyle = 'black';
      ctx.lineWidth = 2;
      ctx.stroke();
      ctx.closePath();

      prevX = currX;
      prevY = currY;
    }

    function clearSignature(e) {
      ctx = canvas.getContext('2d');
      ctx.clearRect(0, 0, canvas.width, canvas.height);

      signature.value = "";
    }

    // function onSubmit(e) {
    //     console.log({
    //         'name': document.getElementsByName('name')[0].value,
    //         'signature': signature.value,
    //     });
    //     return false;
    // }



    document.querySelectorAll('.eval-cell').forEach(cell => {
      cell.addEventListener('click', () => {
        const row = cell.dataset.row;
        const value = cell.dataset.value;

        // ניקוי כל תאי השורה
        document.querySelectorAll(`.eval-cell[data-row="${row}"]`).forEach(c => {
          c.textContent = "";
          c.classList.remove("selected");
        });

        // סימון התא
        cell.textContent = "X";
        cell.classList.add("selected");

        // עדכון select הנסתר
        const select = document.getElementById(`hidden-input-${row}`);
        select.value = value;
        console.log("changing", select.id, select.value)
      });

    });

    function restoreSelectionsFromInputs() {
      const rows = document.querySelectorAll('.eval-table tbody tr');

      rows.forEach((row, rowIndex) => {
        const select = document.getElementById(`hidden-input-${rowIndex}`);
        const selectedValue = select.value;

        if (!selectedValue) return;

        // Clear all cells in the row
        row.querySelectorAll(`.eval-cell[data-row="${rowIndex}"]`).forEach(cell => {
          cell.textContent = "";
          cell.classList.remove("selected");
        });

        // Re-select the correct cell
        const cellToMark = row.querySelector(`.eval-cell[data-row="${rowIndex}"][data-value="${selectedValue}"]`);
        if (cellToMark) {
          cellToMark.textContent = "X";
          cellToMark.classList.add("selected");
        }
      });
    }

    function disableSelecting() {
      document.querySelectorAll('.eval-cell').forEach(cell => {
        cell.style.pointerEvents = "none"
      }); 
    }

    function destroyTableX(){

      const rows = document.querySelectorAll('.eval-table tbody tr');

      rows.forEach((row, rowIndex) => {
        row.querySelectorAll(`.eval-cell[data-row="${rowIndex}"]`).forEach(cell => {
          cell.textContent = "";
          cell.classList.remove("selected");
        });
      });
    }

    // document.getElementById("tsup").addEventListener("click", destroyTableX)
    // document.getElementById("tsup2").addEventListener("click", restoreSelectionsFromInputs)

  </script>



<script>
const htmlStart = "<" + "!DOCTYPE html> \n"
 + "<" + "html lang=\"he\" dir=\"rtl\"> \n"
 + " \n"
 + "<" + "head> \n"
 + "  <" + "meta charset=\"UTF-8\"> \n"
 + "  <" + "title>חוות דעת לקצונה<" + "/title> \n"
 + "  <" + "style> \n"
 + "    body { \n"
 + "      font-family: Arial, sans-serif; \n"
 + "      direction: rtl; \n"
 + "      padding: 20px; \n"
 + "    } \n"
 + " \n"
 + "    label { \n"
 + "      display: block; \n"
 + "      margin-top: 10px; \n"
 + "      font-weight: bold; \n"
 + "    } \n"
 + " \n"
 + "    input, \n"
 + "    select, \n"
 + "    textarea { \n"
 + "      width: 100%; \n"
 + "      margin-bottom: 10px; \n"
 + "      padding: 5px; \n"
 + "    } \n"
 + " \n"
 + "    table { \n"
 + "      width: 100%; \n"
 + "      border-collapse: collapse; \n"
 + "      margin-bottom: 20px; \n"
 + "    } \n"
 + " \n"
 + "    th, \n"
 + "    td { \n"
 + "      border: 1px solid #ccc; \n"
 + "      padding: 8px; \n"
 + "      text-align: right; \n"
 + "    } \n"
 + " \n"
 + "    th { \n"
 + "      background-color: #f2f2f2; \n"
 + "    } \n"
 + " \n"
 + "    h2 { \n"
 + "      background-color: #e0e0e0; \n"
 + "      padding: 10px; \n"
 + "    } \n"
 + " \n"
 + "    button { \n"
 + "      padding: 10px 20px; \n"
 + "      font-size: 16px; \n"
 + "      margin-top: 20px; \n"
 + "    } \n"
 + " \n"
 + "    canvas#signature { \n"
 + "      border: 2px solid black; \n"
 + "    } \n"
 + " \n"
 + " \n"
 + "    .eval-table { \n"
 + "      border-collapse: collapse; \n"
 + "      direction: rtl; \n"
 + "      text-align: center; \n"
 + "      margin: 20px 0; \n"
 + "    } \n"
 + " \n"
 + "    .eval-table th, \n"
 + "    .eval-table td { \n"
 + "      border: 1px solid #999; \n"
 + "      padding: 10px; \n"
 + "      min-width: 80px; \n"
 + "    } \n"
 + " \n"
 + "    .eval-cell { \n"
 + "      cursor: pointer; \n"
 + "    } \n"
 + " \n"
 + "    .eval-cell.selected { \n"
 + "      background-color: #d0f0d0; \n"
 + "      font-weight: bold; \n"
 + "    } \n"
 + " \n"
 + "    .eval-feature { \n"
 + "      background-color: #f0f0f0; \n"
 + "      font-weight: bold; \n"
 + "    } \n"
 + "  <" + "/style> \n"
 + " \n"
 + "  <" + "script src=\"https://cdnjs.cloudflare.com/ajax/libs/pako/2.0.4/pako.min.js\"><" + "/script> \n"
 + "  <" + "!-- Pako from CDN --> \n"
 + "<" + "/head> \n"
 + " \n"
 + "<" + "body> \n"
 + "  <" + "form id=\"feedback-form\"> \n"
 + " \n"
 + "    <" + "fieldset> \n"
 + " \n"
 + "      <" + "label>תאריך:<" + "/label> \n"
 + "      <" + "input type=\"date\" name=\"date\"> \n"
 + " \n"
 + "      <" + "label>קוד סמכות: <" + "/label> \n"
 + "      <" + "input type=\"number\" name=\"samkhut\"> \n"
 + " \n"
 + "      <" + "label>מיועד לקורס: להב/מעוז/נחשון<" + "/label> \n"
 + " \n"
 + "      <" + "h1>חוות דעת של מועמד/ת לקורס קצונה<" + "/h1> \n"
 + " \n"
 + "      <" + "span>פרטי המועמד/ת<" + "/span> \n"
 + " \n"
 + "      <" + "label>שם פרטי בלבד:<" + "/label> \n"
 + "      <" + "input type=\"text\" name=\"firstName\"> \n"
 + " \n"
 + "      <" + "label>מ\"א:<" + "/label> \n"
 + "      <" + "input type=\"text\" name=\"personalNumber\" pattern=\"\d{7}\"> \n"
 + " \n"
 + "      <" + "h2>חלק א: חוות דעת המפקד הישיר<" + "/h2> \n"
 + " \n"
 + "      <" + "label>החייל משרת תחת פיקודי : \n"
 + "        <" + "input type=\"number\" name=\"monthsUnder\" min=\"0\"> \n"
 + "        <" + "span>חודשים <" + "/span> \n"
 + "      <" + "/label> \n"
 + " \n"
 + "      <" + "label>החו\"ד נכתב יחד עם מפקד קודם: \n"
 + "        <" + "input> \n"
 + "        <" + "span>(סמן אם כן) <" + "/span> \n"
 + "      <" + "/label> \n"
 + " \n"
 + "      <" + "label>מידת היכרות עם החייל:<" + "/label> \n"
 + "      <" + "select name=\"familiarity\"> \n"
 + "        <" + "option value=\"\">בחר<" + "/option> \n"
 + "        <" + "option>טובה מאוד<" + "/option> \n"
 + "        <" + "option>די טובה<" + "/option> \n"
 + "        <" + "option>בינונית<" + "/option> \n"
 + "        <" + "option>קלושה<" + "/option> \n"
 + "      <" + "/select> \n"
 + " \n"
 + "      <" + "label>תפקיד נוכחי של החייל\ת (פירוט ברמת בלמ\"ס בלבד):<" + "/label> \n"
 + "      <" + "input type=\"text\" name=\"role\"> \n"
 + " \n"
 + "      <" + "label>תאר את המועמד/ת בטבלה הבאה, תוך התייחסות ל-2 נקודות חוזק ו-2 נקודות חולשה וכיצד הן באות לידי ביטוי על ידי \n"
 + "        הסבר או דוגמה.<" + "/label> \n"
 + "      <" + "table class=\"eval-table\" id=\"eval-table\"> \n"
 + "        <" + "thead> \n"
 + "          <" + "tr> \n"
 + "            <" + "th>מאפיין<" + "/th> \n"
 + "            <" + "th>גבוה מאוד<" + "/th> \n"
 + "            <" + "th>גבוה<" + "/th> \n"
 + "            <" + "th>בינוני<" + "/th> \n"
 + "            <" + "th>נמוך<" + "/th> \n"
 + "            <" + "th>נמוך מאוד<" + "/th> \n"
 + "            <" + "th>לא ניתן להעריך<" + "/th> \n"
 + "          <" + "/tr> \n"
 + "        <" + "/thead> \n"
 + "        <" + "tbody> \n"
 + "          <" + "tr> \n"
 + "            <" + "td class=\"eval-feature\">עצמאות בביצוע משימות<" + "/td> \n"
 + "            <" + "td class=\"eval-cell\" data-row=\"0\" data-value=\"גבוה מאוד\"><" + "/td> \n"
 + "            <" + "td class=\"eval-cell\" data-row=\"0\" data-value=\"גבוה\"><" + "/td> \n"
 + "            <" + "td class=\"eval-cell\" data-row=\"0\" data-value=\"בינוני\"><" + "/td> \n"
 + "            <" + "td class=\"eval-cell\" data-row=\"0\" data-value=\"נמוך\"><" + "/td> \n"
 + "            <" + "td class=\"eval-cell\" data-row=\"0\" data-value=\"נמוך מאוד\"><" + "/td> \n"
 + "            <" + "td class=\"eval-cell\" data-row=\"0\" data-value=\"לא ניתן להעריך\"><" + "/td> \n"
 + "            <" + "td style=\"display:none;\"> \n"
 + "              <" + "select name=\"rating_0\" id=\"hidden-input-0\" hidden> \n"
 + "                <" + "option value=\"\"><" + "/option> \n"
 + "                <" + "option value=\"גבוה מאוד\"><" + "/option> \n"
 + "                <" + "option value=\"גבוה\"><" + "/option> \n"
 + "                <" + "option value=\"בינוני\"><" + "/option> \n"
 + "                <" + "option value=\"נמוך\"><" + "/option> \n"
 + "                <" + "option value=\"נמוך מאוד\"><" + "/option> \n"
 + "                <" + "option value=\"לא ניתן להעריך\"><" + "/option> \n"
 + "              <" + "/select> \n"
 + "            <" + "/td> \n"
 + "          <" + "/tr> \n"
 + " \n"
 + "          <" + "tr> \n"
 + "            <" + "td class=\"eval-feature\">תפקוד יעיל בלחץ ובעומס<" + "/td> \n"
 + "            <" + "td class=\"eval-cell\" data-row=\"1\" data-value=\"גבוה מאוד\"><" + "/td> \n"
 + "            <" + "td class=\"eval-cell\" data-row=\"1\" data-value=\"גבוה\"><" + "/td> \n"
 + "            <" + "td class=\"eval-cell\" data-row=\"1\" data-value=\"בינוני\"><" + "/td> \n"
 + "            <" + "td class=\"eval-cell\" data-row=\"1\" data-value=\"נמוך\"><" + "/td> \n"
 + "            <" + "td class=\"eval-cell\" data-row=\"1\" data-value=\"נמוך מאוד\"><" + "/td> \n"
 + "            <" + "td class=\"eval-cell\" data-row=\"1\" data-value=\"לא ניתן להעריך\"><" + "/td> \n"
 + "            <" + "td style=\"display:none;\"> \n"
 + "              <" + "select name=\"rating_1\" id=\"hidden-input-1\" hidden> \n"
 + "                <" + "option value=\"\"><" + "/option> \n"
 + "                <" + "option value=\"גבוה מאוד\"><" + "/option> \n"
 + "                <" + "option value=\"גבוה\"><" + "/option> \n"
 + "                <" + "option value=\"בינוני\"><" + "/option> \n"
 + "                <" + "option value=\"נמוך\"><" + "/option> \n"
 + "                <" + "option value=\"נמוך מאוד\"><" + "/option> \n"
 + "                <" + "option value=\"לא ניתן להעריך\"><" + "/option> \n"
 + "              <" + "/select> \n"
 + "            <" + "/td> \n"
 + "          <" + "/tr> \n"
 + " \n"
 + "          <" + "tr> \n"
 + "            <" + "td class=\"eval-feature\">קבלת החלטות<" + "/td> \n"
 + "            <" + "td class=\"eval-cell\" data-row=\"2\" data-value=\"גבוה מאוד\"><" + "/td> \n"
 + "            <" + "td class=\"eval-cell\" data-row=\"2\" data-value=\"גבוה\"><" + "/td> \n"
 + "            <" + "td class=\"eval-cell\" data-row=\"2\" data-value=\"בינוני\"><" + "/td> \n"
 + "            <" + "td class=\"eval-cell\" data-row=\"2\" data-value=\"נמוך\"><" + "/td> \n"
 + "            <" + "td class=\"eval-cell\" data-row=\"2\" data-value=\"נמוך מאוד\"><" + "/td> \n"
 + "            <" + "td class=\"eval-cell\" data-row=\"2\" data-value=\"לא ניתן להעריך\"><" + "/td> \n"
 + "            <" + "td style=\"display:none;\"> \n"
 + "              <" + "select name=\"rating_2\" id=\"hidden-input-2\" hidden> \n"
 + "                <" + "option value=\"\"><" + "/option> \n"
 + "                <" + "option value=\"גבוה מאוד\"><" + "/option> \n"
 + "                <" + "option value=\"גבוה\"><" + "/option> \n"
 + "                <" + "option value=\"בינוני\"><" + "/option> \n"
 + "                <" + "option value=\"נמוך\"><" + "/option> \n"
 + "                <" + "option value=\"נמוך מאוד\"><" + "/option> \n"
 + "                <" + "option value=\"לא ניתן להעריך\"><" + "/option> \n"
 + "              <" + "/select> \n"
 + "            <" + "/td> \n"
 + "          <" + "/tr> \n"
 + " \n"
 + "          <" + "tr> \n"
 + "            <" + "td class=\"eval-feature\">משמעת והסתגלות לצרכי המערכת<" + "/td> \n"
 + "            <" + "td class=\"eval-cell\" data-row=\"3\" data-value=\"גבוה מאוד\"><" + "/td> \n"
 + "            <" + "td class=\"eval-cell\" data-row=\"3\" data-value=\"גבוה\"><" + "/td> \n"
 + "            <" + "td class=\"eval-cell\" data-row=\"3\" data-value=\"בינוני\"><" + "/td> \n"
 + "            <" + "td class=\"eval-cell\" data-row=\"3\" data-value=\"נמוך\"><" + "/td> \n"
 + "            <" + "td class=\"eval-cell\" data-row=\"3\" data-value=\"נמוך מאוד\"><" + "/td> \n"
 + "            <" + "td class=\"eval-cell\" data-row=\"3\" data-value=\"לא ניתן להעריך\"><" + "/td> \n"
 + "            <" + "td style=\"display:none;\"> \n"
 + "              <" + "select name=\"rating_3\" id=\"hidden-input-3\" hidden> \n"
 + "                <" + "option value=\"\"><" + "/option> \n"
 + "                <" + "option value=\"גבוה מאוד\"><" + "/option> \n"
 + "                <" + "option value=\"גבוה\"><" + "/option> \n"
 + "                <" + "option value=\"בינוני\"><" + "/option> \n"
 + "                <" + "option value=\"נמוך\"><" + "/option> \n"
 + "                <" + "option value=\"נמוך מאוד\"><" + "/option> \n"
 + "                <" + "option value=\"לא ניתן להעריך\"><" + "/option> \n"
 + "              <" + "/select> \n"
 + "            <" + "/td> \n"
 + "          <" + "/tr> \n"
 + " \n"
 + "          <" + "tr> \n"
 + "            <" + "td class=\"eval-feature\">יכולת חשיבה ולמידה עצמית<" + "/td> \n"
 + "            <" + "td class=\"eval-cell\" data-row=\"4\" data-value=\"גבוה מאוד\"><" + "/td> \n"
 + "            <" + "td class=\"eval-cell\" data-row=\"4\" data-value=\"גבוה\"><" + "/td> \n"
 + "            <" + "td class=\"eval-cell\" data-row=\"4\" data-value=\"בינוני\"><" + "/td> \n"
 + "            <" + "td class=\"eval-cell\" data-row=\"4\" data-value=\"נמוך\"><" + "/td> \n"
 + "            <" + "td class=\"eval-cell\" data-row=\"4\" data-value=\"נמוך מאוד\"><" + "/td> \n"
 + "            <" + "td class=\"eval-cell\" data-row=\"4\" data-value=\"לא ניתן להעריך\"><" + "/td> \n"
 + "            <" + "td style=\"display:none;\"> \n"
 + "              <" + "select name=\"rating_4\" id=\"hidden-input-4\" hidden> \n"
 + "                <" + "option value=\"\"><" + "/option> \n"
 + "                <" + "option value=\"גבוה מאוד\"><" + "/option> \n"
 + "                <" + "option value=\"גבוה\"><" + "/option> \n"
 + "                <" + "option value=\"בינוני\"><" + "/option> \n"
 + "                <" + "option value=\"נמוך\"><" + "/option> \n"
 + "                <" + "option value=\"נמוך מאוד\"><" + "/option> \n"
 + "                <" + "option value=\"לא ניתן להעריך\"><" + "/option> \n"
 + "              <" + "/select> \n"
 + "            <" + "/td> \n"
 + "          <" + "/tr> \n"
 + " \n"
 + "          <" + "tr> \n"
 + "            <" + "td class=\"eval-feature\">עבודת צוות<" + "/td> \n"
 + "            <" + "td class=\"eval-cell\" data-row=\"5\" data-value=\"גבוה מאוד\"><" + "/td> \n"
 + "            <" + "td class=\"eval-cell\" data-row=\"5\" data-value=\"גבוה\"><" + "/td> \n"
 + "            <" + "td class=\"eval-cell\" data-row=\"5\" data-value=\"בינוני\"><" + "/td> \n"
 + "            <" + "td class=\"eval-cell\" data-row=\"5\" data-value=\"נמוך\"><" + "/td> \n"
 + "            <" + "td class=\"eval-cell\" data-row=\"5\" data-value=\"נמוך מאוד\"><" + "/td> \n"
 + "            <" + "td class=\"eval-cell\" data-row=\"5\" data-value=\"לא ניתן להעריך\"><" + "/td> \n"
 + "            <" + "td style=\"display:none;\"> \n"
 + "              <" + "select name=\"rating_5\" id=\"hidden-input-5\" hidden> \n"
 + "                <" + "option value=\"\"><" + "/option> \n"
 + "                <" + "option value=\"גבוה מאוד\"><" + "/option> \n"
 + "                <" + "option value=\"גבוה\"><" + "/option> \n"
 + "                <" + "option value=\"בינוני\"><" + "/option> \n"
 + "                <" + "option value=\"נמוך\"><" + "/option> \n"
 + "                <" + "option value=\"נמוך מאוד\"><" + "/option> \n"
 + "                <" + "option value=\"לא ניתן להעריך\"><" + "/option> \n"
 + "              <" + "/select> \n"
 + "            <" + "/td> \n"
 + "          <" + "/tr> \n"
 + " \n"
 + "          <" + "tr> \n"
 + "            <" + "td class=\"eval-feature\">אסרטיביות ויכולת הובלה<" + "/td> \n"
 + "            <" + "td class=\"eval-cell\" data-row=\"6\" data-value=\"גבוה מאוד\"><" + "/td> \n"
 + "            <" + "td class=\"eval-cell\" data-row=\"6\" data-value=\"גבוה\"><" + "/td> \n"
 + "            <" + "td class=\"eval-cell\" data-row=\"6\" data-value=\"בינוני\"><" + "/td> \n"
 + "            <" + "td class=\"eval-cell\" data-row=\"6\" data-value=\"נמוך\"><" + "/td> \n"
 + "            <" + "td class=\"eval-cell\" data-row=\"6\" data-value=\"נמוך מאוד\"><" + "/td> \n"
 + "            <" + "td class=\"eval-cell\" data-row=\"6\" data-value=\"לא ניתן להעריך\"><" + "/td> \n"
 + "            <" + "td style=\"display:none;\"> \n"
 + "              <" + "select name=\"rating_6\" id=\"hidden-input-6\" hidden> \n"
 + "                <" + "option value=\"\"><" + "/option> \n"
 + "                <" + "option value=\"גבוה מאוד\"><" + "/option> \n"
 + "                <" + "option value=\"גבוה\"><" + "/option> \n"
 + "                <" + "option value=\"בינוני\"><" + "/option> \n"
 + "                <" + "option value=\"נמוך\"><" + "/option> \n"
 + "                <" + "option value=\"נמוך מאוד\"><" + "/option> \n"
 + "                <" + "option value=\"לא ניתן להעריך\"><" + "/option> \n"
 + "              <" + "/select> \n"
 + "            <" + "/td> \n"
 + "          <" + "/tr> \n"
 + "        <" + "/tbody> \n"
 + "      <" + "/table> \n"
 + " \n"
 + " \n"
 + "      <" + "label>מה מידת המוטיבציה של החייל לצאת לקצונה:<" + "/label> \n"
 + "      <" + "select name=\"motivation\"> \n"
 + "        <" + "option value=\"\">בחר<" + "/option> \n"
 + "        <" + "option>גבוהה מאוד<" + "/option> \n"
 + "        <" + "option>גבוהה<" + "/option> \n"
 + "        <" + "option>בינונית<" + "/option> \n"
 + "        <" + "option>נמוכה<" + "/option> \n"
 + "        <" + "option>איני רוצה לצאת<" + "/option> \n"
 + "      <" + "/select> \n"
 + " \n"
 + "      <" + "label>תחומים בהם החייל עלול להתקשות בקורס קצינים / בתפקיד:<" + "/label> \n"
 + "      <" + "textarea name=\"difficultyAreas\" rows=\"3\"><" + "/textarea> \n"
 + " \n"
 + "      <" + "label>עד כמה מתאים/ה החייל/ת לקצונה ביחס לחיילים אחרים בתפקידים דומים?<" + "/label> \n"
 + "      <" + "select name=\"suitabilityCompared\"> \n"
 + "        <" + "option value=\"\">בחר<" + "/option> \n"
 + "        <" + "option>יותר מרוב החיילים<" + "/option> \n"
 + "        <" + "option>כמו רוב החיילים<" + "/option> \n"
 + "        <" + "option>פחות מרוב החיילים<" + "/option> \n"
 + "        <" + "option>אינו מתאים כלל<" + "/option> \n"
 + "      <" + "/select> \n"
 + " \n"
 + "      <" + "label>עד כמה תהיה מוכן לקבל את החייל/ת תחת פיקודך כקצין/ה?<" + "/label> \n"
 + "      <" + "select name=\"willingnessCommand\"> \n"
 + "        <" + "option value=\"\">בחר<" + "/option> \n"
 + "        <" + "option>במידה רבה מאוד<" + "/option> \n"
 + "        <" + "option>במידה רבה<" + "/option> \n"
 + "        <" + "option>במידה בינונית<" + "/option> \n"
 + "        <" + "option>במידה מועטה<" + "/option> \n"
 + "        <" + "option>לא מעוניין כלל<" + "/option> \n"
 + "      <" + "/select> \n"
 + " \n"
 + "      <" + "h3>פרטי המפקד:<" + "/h3> \n"
 + "      <" + "label>שם פרטי:<" + "/label> \n"
 + "      <" + "input type=\"text\" name=\"commanderName\"> \n"
 + " \n"
 + "      <" + "label>טלפון:<" + "/label> \n"
 + "      <" + "input type=\"text\" name=\"commanderPhone\" pattern=\"\d{10}\"> \n"
 + " \n"
 + "      <" + "label>משוב לחוות הדעת - שם פרטי:<" + "/label> \n"
 + "      <" + "input type=\"text\" name=\"feedbackName\"> \n"
 + " \n"
 + "      <" + "input type=\"hidden\" name=\"signature\" /> \n"
 + "      <" + "canvas id=\"signature\" width=\"400\" height=\"150\" style=\"border:1px solid #ccc;\"><" + "/canvas> \n"
 + " \n"
 + "      <" + "button type=\"button\" onclick=\"clearSignature()\">נקה חתימה<" + "/button> \n"
 + " \n"
 + "      <" + "h2>חוות דעת מפקדו של המפקד הישיר<" + "/h2> \n"
 + " \n"
 + "      <" + "label>משך היכרותך עם החייל (בחודשים):<" + "/label> \n"
 + "      <" + "input type=\"number\" name=\"monthsUnder2\" min=\"0\"> \n"
 + " \n"
 + "      <" + "label>מידת היכרות:<" + "/label> \n"
 + "      <" + "select name=\"familiarity2\"> \n"
 + "        <" + "option value=\"\">בחר<" + "/option> \n"
 + "        <" + "option>טובה מאוד<" + "/option> \n"
 + "        <" + "option>די טובה<" + "/option> \n"
 + "        <" + "option>בינונית<" + "/option> \n"
 + "        <" + "option>קלושה<" + "/option> \n"
 + "        <" + "option>איני יכול להעריך<" + "/option> \n"
 + "      <" + "/select> \n"
 + " \n"
 + "      <" + "label>נקודת חוזק:<" + "/label> \n"
 + "      <" + "input type=\"text\" name=\"strength2\"> \n"
 + " \n"
 + "      <" + "label>נקודת חולשה:<" + "/label> \n"
 + "      <" + "input type=\"text\" name=\"weakness2\"> \n"
 + " \n"
 + "      <" + "label>עד כמה תהיה מוכן שהחייל ישרת תחת פיקודך כקצין:<" + "/label> \n"
 + "      <" + "select name=\"willingnessCommand2\"> \n"
 + "        <" + "option value=\"\">בחר<" + "/option> \n"
 + "        <" + "option>במידה רבה מאוד<" + "/option> \n"
 + "        <" + "option>במידה רבה<" + "/option> \n"
 + "        <" + "option>במידה בינונית<" + "/option> \n"
 + "        <" + "option>במידה מועטה<" + "/option> \n"
 + "        <" + "option>לא מעוניין כלל<" + "/option> \n"
 + "      <" + "/select> \n"
 + " \n"
 + "      <" + "label>הערות נוספות:<" + "/label> \n"
 + "      <" + "textarea name=\"additionalComments\" rows=\"3\"><" + "/textarea> \n"
 + " \n"
 + "      <" + "h3>פרטי מפקדו של המפקד הישיר:<" + "/h3> \n"
 + "      <" + "label>שם פרטי בלבד:<" + "/label> \n"
 + "      <" + "input type=\"text\" name=\"commander2Name\"> \n"
 + " \n"
 + "      <" + "label>טלפון (10 ספרות):<" + "/label> \n"
 + "      <" + "input type=\"text\" name=\"commander2Phone\" pattern=\"\d{10}\"> \n"
 + " \n"
 + "      <" + "button type=\"button\" id=\"send-form\">שלח במייל<" + "/button> \n"
 + "    <" + "/fieldset> \n"
 + " \n"
 + "  <" + "/form> \n"
 + " \n"
 + "  <" + "!-- <" + "button id=\"tsup\">Tsup<" + "/button> \n"
 + "  <" + "button id=\"tsup2\">Tsup2<" + "/button> --> \n"
 + " \n"
 + " \n"
 + "  <" + "script> \n"
 + " \n"
 + "    // פונקציה לניקוי חתימה \n"
 + "    function clearSignature() { \n"
 + "      const canvas = document.getElementById(\"signature-pad\"); \n"
 + "      const ctx = canvas.getContext(\"2d\"); \n"
 + "      ctx.clearRect(0, 0, canvas.width, canvas.height); \n"
 + "    } \n"
 + " \n"
 + "  <" + "/script> \n"
 + " \n"
 + "  <" + "script> \n"
 + " \n"
 + " \n"
 + "    var canvas = document.getElementById('signature'); \n"
 + "    var ctx = canvas.getContext(\"2d\"); \n"
 + "    var drawing = false; \n"
 + "    var prevX, prevY; \n"
 + "    var currX, currY; \n"
 + "    var signature = document.getElementsByName('signature')[0]; \n"
 + " \n"
 + "    canvas.addEventListener(\"mousemove\", draw); \n"
 + "    document.addEventListener(\"mouseup\", stop); \n"
 + "    canvas.addEventListener(\"mousedown\", start); \n"
 + " \n"
 + "    // function blah(e) { \n"
 + "    //   setCanvasElFromHiddenInput() \n"
 + "    // } \n"
 + " \n"
 + "    function setCanvasElFromHiddenInput() { \n"
 + "      const img = new Image() \n"
 + "      img.src = signature.value \n"
 + " \n"
 + "      img.addEventListener(\"load\", () => { \n"
 + "        canvas.getContext('2d').drawImage(img, 0, 0) \n"
 + "      }) \n"
 + "    } \n"
 + " \n"
 + " \n"
 + "    function start(e) { \n"
 + " \n"
 + "      console.log(\"starting to draw\", signature.value[0], signature.value[1]) \n"
 + "      drawing = true; \n"
 + "    } \n"
 + " \n"
 + "    function stop() { \n"
 + " \n"
 + "      if (drawing) { \n"
 + " \n"
 + "        console.log(\"stopping drawing\") \n"
 + "        drawing = false; \n"
 + "        prevX = prevY = null; \n"
 + "        signature.value = canvas.toDataURL(); \n"
 + " \n"
 + "      } \n"
 + "    } \n"
 + " \n"
 + "    function draw(e) { \n"
 + " \n"
 + "      if (!drawing) { \n"
 + "        return; \n"
 + "      } \n"
 + " \n"
 + "      console.log(\"well... drawing\") \n"
 + " \n"
 + "      // Test for touchmove event, this requires another property. \n"
 + "      var clientX = e.type === 'touchmove' ? e.touches[0].clientX : e.clientX; \n"
 + "      var clientY = e.type === 'touchmove' ? e.touches[0].clientY : e.clientY; \n"
 + " \n"
 + "      console.log(clientX, clientY) \n"
 + " \n"
 + "      currX = clientX - canvas.getBoundingClientRect().left; \n"
 + "      currY = clientY - canvas.getBoundingClientRect().top; \n"
 + " \n"
 + "      // console.log(currX, currY) \n"
 + " \n"
 + "      if (!prevX && !prevY) { \n"
 + "        prevX = currX; \n"
 + "        prevY = currY; \n"
 + "      } \n"
 + " \n"
 + "      ctx.beginPath(); \n"
 + "      ctx.moveTo(prevX, prevY); \n"
 + "      ctx.lineTo(currX, currY); \n"
 + "      ctx.strokeStyle = 'black'; \n"
 + "      ctx.lineWidth = 2; \n"
 + "      ctx.stroke(); \n"
 + "      ctx.closePath(); \n"
 + " \n"
 + "      prevX = currX; \n"
 + "      prevY = currY; \n"
 + "    } \n"
 + " \n"
 + "    function clearSignature(e) { \n"
 + "      ctx = canvas.getContext('2d'); \n"
 + "      ctx.clearRect(0, 0, canvas.width, canvas.height); \n"
 + " \n"
 + "      signature.value = \"\"; \n"
 + "    } \n"
 + " \n"
 + "    // function onSubmit(e) { \n"
 + "    //     console.log({ \n"
 + "    //         'name': document.getElementsByName('name')[0].value, \n"
 + "    //         'signature': signature.value, \n"
 + "    //     }); \n"
 + "    //     return false; \n"
 + "    // } \n"
 + " \n"
 + " \n"
 + " \n"
 + "    document.querySelectorAll('.eval-cell').forEach(cell => { \n"
 + "      cell.addEventListener('click', () => { \n"
 + "        const row = cell.dataset.row; \n"
 + "        const value = cell.dataset.value; \n"
 + " \n"
 + "        // ניקוי כל תאי השורה \n"
 + "        document.querySelectorAll(`.eval-cell[data-row=\"${row}\"]`).forEach(c => { \n"
 + "          c.textContent = \"\"; \n"
 + "          c.classList.remove(\"selected\"); \n"
 + "        }); \n"
 + " \n"
 + "        // סימון התא \n"
 + "        cell.textContent = \"X\"; \n"
 + "        cell.classList.add(\"selected\"); \n"
 + " \n"
 + "        // עדכון select הנסתר \n"
 + "        const select = document.getElementById(`hidden-input-${row}`); \n"
 + "        select.value = value; \n"
 + "        console.log(\"changing\", select.id, select.value) \n"
 + "      }); \n"
 + " \n"
 + "    }); \n"
 + " \n"
 + "    function restoreSelectionsFromInputs() { \n"
 + "      const rows = document.querySelectorAll('.eval-table tbody tr'); \n"
 + " \n"
 + "      rows.forEach((row, rowIndex) => { \n"
 + "        const select = document.getElementById(`hidden-input-${rowIndex}`); \n"
 + "        const selectedValue = select.value; \n"
 + " \n"
 + "        if (!selectedValue) return; \n"
 + " \n"
 + "        // Clear all cells in the row \n"
 + "        row.querySelectorAll(`.eval-cell[data-row=\"${rowIndex}\"]`).forEach(cell => { \n"
 + "          cell.textContent = \"\"; \n"
 + "          cell.classList.remove(\"selected\"); \n"
 + "        }); \n"
 + " \n"
 + "        // Re-select the correct cell \n"
 + "        const cellToMark = row.querySelector(`.eval-cell[data-row=\"${rowIndex}\"][data-value=\"${selectedValue}\"]`); \n"
 + "        if (cellToMark) { \n"
 + "          cellToMark.textContent = \"X\"; \n"
 + "          cellToMark.classList.add(\"selected\"); \n"
 + "        } \n"
 + "      }); \n"
 + "    } \n"
 + " \n"
 + "    function disableSelecting() { \n"
 + "      document.querySelectorAll('.eval-cell').forEach(cell => { \n"
 + "        cell.style.pointerEvents = \"none\" \n"
 + "      });  \n"
 + "    } \n"
 + " \n"
 + "    function destroyTableX(){ \n"
 + " \n"
 + "      const rows = document.querySelectorAll('.eval-table tbody tr'); \n"
 + " \n"
 + "      rows.forEach((row, rowIndex) => { \n"
 + "        row.querySelectorAll(`.eval-cell[data-row=\"${rowIndex}\"]`).forEach(cell => { \n"
 + "          cell.textContent = \"\"; \n"
 + "          cell.classList.remove(\"selected\"); \n"
 + "        }); \n"
 + "      }); \n"
 + "    } \n"
 + " \n"
 + "    // document.getElementById(\"tsup\").addEventListener(\"click\", destroyTableX) \n"
 + "    // document.getElementById(\"tsup2\").addEventListener(\"click\", restoreSelectionsFromInputs) \n"
 + " \n"
 + "  <" + "/script> \n"
 + " \n"
 + " \n"
;const htmlEnd = "<" + "/body> \n"
 + " \n"
 + "<" + "/html> \n"
;
// שליחת הטופס במייל
function submitAndEmail(e) {

    alert("siuuu")

    // e.preventDefault()

    const form = document.getElementById('feedback-form');
    if (!form.checkValidity()) {
        form.reportValidity();
        return;
    }
    const formData = new FormData(form);
    script_str = ""

    for (const [name, val] of formData.entries()) {
        script_str += ("document.getElementsByName('" + name + "')[0].value = '" + val + "';\n")
    }

    htmlFile = htmlStart
        + "\n<" + "script>\n"
        + script_str
        + "\ndocument.querySelector('fieldset').disabled = true;\n "
        + "\ndocument.getElementById('send-form').style.display = 'none';\n "
        + "\nsetCanvasElFromHiddenInput()\n;"
        + "\ncanvas.style.pointerEvents='none' \n"
        + '\nrestoreSelectionsFromInputs()\n'
        + '\ndisableSelecting()\n'
        + "\n<" + "/script>\n"
        + htmlEnd

    // console.log("htmlFile: " + htmlFile)

    const blob = new Blob([htmlFile], { type: 'text/plain' });
    const a = document.createElement('a');
    a.href = URL.createObjectURL(blob);
    a.download = 'form_data.html';
    a.click();
    URL.revokeObjectURL(a.href);

}

document.getElementById("send-form").addEventListener("click", submitAndEmail)
</script>
</body>

</html>
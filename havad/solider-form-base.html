<!DOCTYPE html>
<html lang="he" dir="rtl">

<head>
  <meta charset="UTF-8">
  <title>חוות דעת לקצונה</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      direction: rtl;
      padding: 20px;
    }

    label {
      display: block;
      margin-top: 10px;
      font-weight: bold;
    }

    input,
    select,
    textarea {
      width: 100%;
      margin-bottom: 10px;
      padding: 5px;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      margin-bottom: 20px;
    }

    th,
    td {
      border: 1px solid #ccc;
      padding: 8px;
      text-align: right;
    }

    th {
      background-color: #f2f2f2;
    }

    h2 {
      background-color: #e0e0e0;
      padding: 10px;
    }

    button {
      padding: 10px 20px;
      font-size: 16px;
      margin-top: 20px;
    }

    canvas#signature {
      border: 2px solid black;
    }


    .eval-table {
      border-collapse: collapse;
      direction: rtl;
      text-align: center;
      margin: 20px 0;
    }

    .eval-table th,
    .eval-table td {
      border: 1px solid #999;
      padding: 10px;
      min-width: 80px;
    }

    .eval-cell {
      cursor: pointer;
    }

    .eval-cell.selected {
      background-color: #d0f0d0;
      font-weight: bold;
    }

    .eval-feature {
      background-color: #f0f0f0;
      font-weight: bold;
    }
  </style>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/pako/2.0.4/pako.min.js"></script>
  <!-- Pako from CDN -->
</head>

<body>
  <form id="feedback-form">

    <fieldset>

      <label>תאריך:</label>
      <input type="date" name="date">

      <label>קוד סמכות: </label>
      <input type="number" name="samkhut">

      <label>מיועד לקורס: להב/מעוז/נחשון</label>

      <h1>חוות דעת של מועמד/ת לקורס קצונה</h1>

      <div>
        כמפקד, חוות הדעת שלך אודות המועמד מהווה כלי חשוב בעיצוב דור הקצינים הבא של צה"ל. לכן, ככל שהערכותיך יהיו מדויקות
        יותר, כך תתאפשר קבלת החלטות נכונה ואחראית, הן כלפי המערכת והן כלפי הפרט עצמו.
      </div>

      <span>פרטי המועמד/ת</span>

      <label>שם פרטי בלבד:</label>
      <input type="text" name="firstName">

      <label>מ"א:</label>
      <input type="text" name="personalNumber" pattern="\d{7}">

      <h2>חלק א: חוות דעת המפקד הישיר</h2>

      <label>החייל משרת תחת פיקודי :
        <input type="number" name="monthsUnder" min="0">
        <span>חודשים </span>
      </label>

      <label>החו"ד נכתב יחד עם מפקד קודם:
        <input type="checkbox" name="writtenUnderLast">
        <span>(סמן אם כן) </span>
      </label>

      <label>מידת היכרות עם החייל/ת:</label>
      <select name="familiarity">
        <option value="">בחר</option>
        <option>טובה מאוד</option>
        <option>די טובה</option>
        <option>בינונית</option>
        <option>קלושה</option>
      </select>

      <label>תפקידו/ה הנוכחי של החייל\ת (פירוט ברמת בלמ"ס בלבד):</label>
      <input type="text" name="role">

      <label>1. תאר את המועמד/ת בטבלה הבאה, תוך התייחסות ל-2 נקודות חוזק ו-2 נקודות חולשה וכיצד הן באות לידי ביטוי על ידי
        הסבר או דוגמה.</label>
      <table style="border-collapse: collapse; text-align: right;">
        <thead>
          <tr>
            <th></th>
            <th>מאפייני החייל/ת</th>
            <th>הסבר/דוגמה</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>נקודות חוזק</td>
            <td>
              <div style="display: flex; flex-direction: column;">
                <input type="text" name="strength1" placeholder="מאפיין ראשון">
                <hr style="width: 100%;">
                <input type="text" name="strength2" placeholder="מאפיין שני">
              </div>
            </td>
            <td><input type="text" name="strengthExample" style="width: 100%;" placeholder="הסבר או דוגמה"></td>
          </tr>
          <tr>
            <td>נקודות חולשה</td>
            <td>
              <div style="display: flex; flex-direction: column;">
                <input type="text" name="weakness1" placeholder="מאפיין ראשון">
                <hr style="width: 100%;">
                <input type="text" name="weakness2" placeholder="מאפיין שני">
              </div>
            </td>
            <td><input type="text" name="weaknessExample" style="width: 100%;" placeholder="הסבר או דוגמה"></td>
          </tr>
        </tbody>
      </table>

      <label>2. דרג/י את החייל/ת לפי המאפיינים הבאים (סמן X במשבצת המתאימה): שים לב! ניתן לבחור עד שלושה מאפיינים בקטגוריה
        "גבוה מאוד" ועד שלושה מאפיינים בקטגוריה "גבוה"
      </label>
      <table class="eval-table" id="eval-table">
        <thead>
          <tr>
            <th>מאפיין</th>
            <th>גבוה מאוד</th>
            <th>גבוה</th>
            <th>בינוני</th>
            <th>נמוך</th>
            <th>נמוך מאוד</th>
            <th>לא ניתן להעריך</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td class="eval-feature">עצמאות בביצוע משימות</td>
            <td class="eval-cell" data-row="0" data-value="גבוה מאוד"></td>
            <td class="eval-cell" data-row="0" data-value="גבוה"></td>
            <td class="eval-cell" data-row="0" data-value="בינוני"></td>
            <td class="eval-cell" data-row="0" data-value="נמוך"></td>
            <td class="eval-cell" data-row="0" data-value="נמוך מאוד"></td>
            <td class="eval-cell" data-row="0" data-value="לא ניתן להעריך"></td>
            <td style="display:none;">
              <select name="rating_0" id="hidden-input-0" hidden>
                <option value=""></option>
                <option value="גבוה מאוד"></option>
                <option value="גבוה"></option>
                <option value="בינוני"></option>
                <option value="נמוך"></option>
                <option value="נמוך מאוד"></option>
                <option value="לא ניתן להעריך"></option>
              </select>
            </td>
          </tr>

          <tr>
            <td class="eval-feature">תפקוד יעיל בלחץ ובעומס</td>
            <td class="eval-cell" data-row="1" data-value="גבוה מאוד"></td>
            <td class="eval-cell" data-row="1" data-value="גבוה"></td>
            <td class="eval-cell" data-row="1" data-value="בינוני"></td>
            <td class="eval-cell" data-row="1" data-value="נמוך"></td>
            <td class="eval-cell" data-row="1" data-value="נמוך מאוד"></td>
            <td class="eval-cell" data-row="1" data-value="לא ניתן להעריך"></td>
            <td style="display:none;">
              <select name="rating_1" id="hidden-input-1" hidden>
                <option value=""></option>
                <option value="גבוה מאוד"></option>
                <option value="גבוה"></option>
                <option value="בינוני"></option>
                <option value="נמוך"></option>
                <option value="נמוך מאוד"></option>
                <option value="לא ניתן להעריך"></option>
              </select>
            </td>
          </tr>

          <tr>
            <td class="eval-feature">קבלת החלטות</td>
            <td class="eval-cell" data-row="2" data-value="גבוה מאוד"></td>
            <td class="eval-cell" data-row="2" data-value="גבוה"></td>
            <td class="eval-cell" data-row="2" data-value="בינוני"></td>
            <td class="eval-cell" data-row="2" data-value="נמוך"></td>
            <td class="eval-cell" data-row="2" data-value="נמוך מאוד"></td>
            <td class="eval-cell" data-row="2" data-value="לא ניתן להעריך"></td>
            <td style="display:none;">
              <select name="rating_2" id="hidden-input-2" hidden>
                <option value=""></option>
                <option value="גבוה מאוד"></option>
                <option value="גבוה"></option>
                <option value="בינוני"></option>
                <option value="נמוך"></option>
                <option value="נמוך מאוד"></option>
                <option value="לא ניתן להעריך"></option>
              </select>
            </td>
          </tr>

          <tr>
            <td class="eval-feature">משמעת והסתגלות לצרכי המערכת</td>
            <td class="eval-cell" data-row="3" data-value="גבוה מאוד"></td>
            <td class="eval-cell" data-row="3" data-value="גבוה"></td>
            <td class="eval-cell" data-row="3" data-value="בינוני"></td>
            <td class="eval-cell" data-row="3" data-value="נמוך"></td>
            <td class="eval-cell" data-row="3" data-value="נמוך מאוד"></td>
            <td class="eval-cell" data-row="3" data-value="לא ניתן להעריך"></td>
            <td style="display:none;">
              <select name="rating_3" id="hidden-input-3" hidden>
                <option value=""></option>
                <option value="גבוה מאוד"></option>
                <option value="גבוה"></option>
                <option value="בינוני"></option>
                <option value="נמוך"></option>
                <option value="נמוך מאוד"></option>
                <option value="לא ניתן להעריך"></option>
              </select>
            </td>
          </tr>

          <tr>
            <td class="eval-feature">יכולת חשיבה ולמידה עצמית</td>
            <td class="eval-cell" data-row="4" data-value="גבוה מאוד"></td>
            <td class="eval-cell" data-row="4" data-value="גבוה"></td>
            <td class="eval-cell" data-row="4" data-value="בינוני"></td>
            <td class="eval-cell" data-row="4" data-value="נמוך"></td>
            <td class="eval-cell" data-row="4" data-value="נמוך מאוד"></td>
            <td class="eval-cell" data-row="4" data-value="לא ניתן להעריך"></td>
            <td style="display:none;">
              <select name="rating_4" id="hidden-input-4" hidden>
                <option value=""></option>
                <option value="גבוה מאוד"></option>
                <option value="גבוה"></option>
                <option value="בינוני"></option>
                <option value="נמוך"></option>
                <option value="נמוך מאוד"></option>
                <option value="לא ניתן להעריך"></option>
              </select>
            </td>
          </tr>

          <tr>
            <td class="eval-feature">עבודת צוות</td>
            <td class="eval-cell" data-row="5" data-value="גבוה מאוד"></td>
            <td class="eval-cell" data-row="5" data-value="גבוה"></td>
            <td class="eval-cell" data-row="5" data-value="בינוני"></td>
            <td class="eval-cell" data-row="5" data-value="נמוך"></td>
            <td class="eval-cell" data-row="5" data-value="נמוך מאוד"></td>
            <td class="eval-cell" data-row="5" data-value="לא ניתן להעריך"></td>
            <td style="display:none;">
              <select name="rating_5" id="hidden-input-5" hidden>
                <option value=""></option>
                <option value="גבוה מאוד"></option>
                <option value="גבוה"></option>
                <option value="בינוני"></option>
                <option value="נמוך"></option>
                <option value="נמוך מאוד"></option>
                <option value="לא ניתן להעריך"></option>
              </select>
            </td>
          </tr>

          <tr>
            <td class="eval-feature">אסרטיביות ויכולת הובלה</td>
            <td class="eval-cell" data-row="6" data-value="גבוה מאוד"></td>
            <td class="eval-cell" data-row="6" data-value="גבוה"></td>
            <td class="eval-cell" data-row="6" data-value="בינוני"></td>
            <td class="eval-cell" data-row="6" data-value="נמוך"></td>
            <td class="eval-cell" data-row="6" data-value="נמוך מאוד"></td>
            <td class="eval-cell" data-row="6" data-value="לא ניתן להעריך"></td>
            <td style="display:none;">
              <select name="rating_6" id="hidden-input-6" hidden>
                <option value=""></option>
                <option value="גבוה מאוד"></option>
                <option value="גבוה"></option>
                <option value="בינוני"></option>
                <option value="נמוך"></option>
                <option value="נמוך מאוד"></option>
                <option value="לא ניתן להעריך"></option>
              </select>
            </td>
          </tr>
        </tbody>
      </table>


      <label>3. מה מידת המוטיבציה של החייל/ת לצאת לקצונה:</label>
      <div id="motivation">
        <label><input type="checkbox" name="motivation" value="גבוהה מאוד"> גבוהה מאוד</label>
        <label><input type="checkbox" name="motivation" value="גבוהה"> גבוהה</label>
        <label><input type="checkbox" name="motivation" value="בינונית"> בינונית</label>
        <label><input type="checkbox" name="motivation" value="נמוכה"> נמוכה</label>
        <label><input type="checkbox" name="motivation" value="איני רוצה לצאת"> איני רוצה לצאת</label>
      </div>

      <label>4. תחומים בהם החייל/ת עלול/ה להתקשות בקורס קצינים / בתפקיד:</label>
      <textarea name="difficultyAreas" rows="3"></textarea>

      <label>5. איזו מידה מתאים/ה החייל/ת לקצונה ביחס לחיילים אחרים ?</label>
      <div id="suitabilityCompared">
        <label><input type="checkbox" name="suitabilityCompared" value="יותר מרוב החיילים בתפקידים דומים"> יותר מרוב
          החיילים בתפקידים דומים</label>
        <label><input type="checkbox" name="suitabilityCompared" value="כמו רוב החיילים בתפקידים דומים"> כמו רוב החיילים
          בתפקידים דומים</label>
        <label><input type="checkbox" name="suitabilityCompared" value="פחות מרוב החיילים בתפקידים דומים"> פחות מרוב
          החיילים בתפקידים דומים</label>
        <label><input type="checkbox" name="suitabilityCompared" value="אינו מתאים/ה כלל לקצונה">אינו מתאים/ה כלל
          לקצונה</label>
      </div>

      <label>6. באיזו מידה תהיה/י מוכן/ה לקבל את החייל/ת תחת פיקודך כקצין/ה?</label>
      <div id="willingnessCommand">
        <label><input type="checkbox" name="willingnessCommand" value="במידה רבה מאוד"> במידה רבה מאוד</label>
        <label><input type="checkbox" name="willingnessCommand" value="במידה רבה"> במידה רבה</label>
        <label><input type="checkbox" name="willingnessCommand" value="במידה בינונית"> במידה בינונית</label>
        <label><input type="checkbox" name="willingnessCommand" value="במידה מועטה"> במידה מועטה</label>
        <label><input type="checkbox" name="willingnessCommand" value="לא מעוניין כלל"> לא מעוניין כלל</label>
      </div>

      <div>
        <h3>פרטי המפקד/ת הישיר/ה:</h3>
        <label>שם פרטי בלבד:</label>
        <input type="text" name="commanderName">

        <label>טלפון:</label>
        <input type="text" name="commanderPhone" pattern="\d{10}">

      </div>

      <span>
        שים/י לב! תוכן הטופב חסוי וישמש את הגורמים המקצועיים בלבד. עם זאת, חובה להביא את החו"ד לעיתו של המועמד ולבצע
        שיחת משוב לחוות הדעת שנכתבה!
        חתימת המועמד/הצהרת המפקד/ת שנערכו שיחות משוב לחוות דעת
      </span>

      <div>
        <label>שם פרטי בלבד:</label>
        <input type="text" name="feedbackName">

        <label>חתימה:</label>
        <input type="hidden" name="signature" />
        <canvas id="signature" width="400" height="150" style="border:1px solid #ccc;"></canvas>

        <button type="button" onclick="clearSignature()">נקה חתימה</button>

      </div>

      <h2>חלק ב': דעת מפקדו של המפקד הישיר</h2>

      <label>1. משך היכרותך עם החייל בחודשים</label>
      <input type="number" name="monthsUnder2" min="0">

      <label>מידת היכרות:</label>
      <div id="familiarity2">
        <label><input type="checkbox" name="familiarity2" value="טובה מאוד"> טובה מאוד</label>
        <label><input type="checkbox" name="familiarity2" value="די טובה"> די טובה</label>
        <label><input type="checkbox" name="familiarity2" value="בינונית"> בינונית</label>
        <label><input type="checkbox" name="familiarity2" value="קלושה"> קלושה</label>
        <label><input type="checkbox" name="familiarity2" value="איני יכול/ה להעריך"> איני יכול להעריך</label>
      </div>

      <div>
        2.תאר/י את מידת ההתאמה של החייל/ת לקצונה, תוך התייחסות לנקודות חוזק וחולשה שלו/ה:
        <label>נקודת חוזק:</label>
        <input type="text" name="strength2">

        <label>נקודת חולשה:</label>
        <input type="text" name="weakness2">
      </div>

      <label>
        3. באיזו מידה תהיה/י מוכן/ה לקבל את המועמד/ת כקצין/ה תחת פיקודיך? (ללא קשר לאילוצי כ"א )
      </label>
      <div id="willingnessCommand2">
        <label><input type="checkbox" name="willingnessCommand2" value="במידה רבה מאוד"> במידה רבה מאוד</label>
        <label><input type="checkbox" name="willingnessCommand2" value="במידה רבה"> במידה רבה</label>
        <label><input type="checkbox" name="willingnessCommand2" value="במידה בינונית"> במידה בינונית</label>
        <label><input type="checkbox" name="willingnessCommand2" value="במידה מועטה"> במידה מועטה</label>
        <label><input type="checkbox" id="siuu" name="willingnessCommand2" value="לא מעוניין כלל"> לא מעוניין
          כלל</label>
      </div>

      <label>4. הערות נוספות:</label>
      <textarea name="additionalComments" rows="3"></textarea>

      <h3>פרטי מפקדו של המפקד הישיר:</h3>
      <label>שם פרטי בלבד:</label>
      <input type="text" name="commander2Name">

      <label>טלפון:</label>
      <input type="text" name="commander2Phone" pattern="\d{10}">

      <button type="button" id="send-form">שלח במייל</button>
    </fieldset>

  </form>

  <!-- <button id="tsup">Tsup</button>
  <button id="tsup2">Tsup2</button> -->


  <script>

    // console.log( document.querySelector("input[value='במידה מועטה']")  )

    // פונקציה לניקוי חתימה
    function clearSignature() {
      const canvas = document.getElementById("signature-pad");
      const ctx = canvas.getContext("2d");
      ctx.clearRect(0, 0, canvas.width, canvas.height);
    }

  </script>

  <script>


    var canvas = document.getElementById('signature');
    var ctx = canvas.getContext("2d");
    var drawing = false;
    var prevX, prevY;
    var currX, currY;
    var signature = document.getElementsByName('signature')[0];

    canvas.addEventListener("mousemove", draw);
    document.addEventListener("mouseup", stop);
    canvas.addEventListener("mousedown", start);

    // function blah(e) {
    //   setCanvasElFromHiddenInput()
    // }

    function setCanvasElFromHiddenInput() {
      const img = new Image()
      img.src = signature.value

      img.addEventListener("load", () => {
        canvas.getContext('2d').drawImage(img, 0, 0)
      })
    }


    function start(e) {

      console.log("starting to draw", signature.value[0], signature.value[1])
      drawing = true;
    }

    function stop() {

      if (drawing) {

        console.log("stopping drawing")
        drawing = false;
        prevX = prevY = null;
        signature.value = canvas.toDataURL();

      }
    }

    function draw(e) {

      if (!drawing) {
        return;
      }

      console.log("well... drawing")

      // Test for touchmove event, this requires another property.
      var clientX = e.type === 'touchmove' ? e.touches[0].clientX : e.clientX;
      var clientY = e.type === 'touchmove' ? e.touches[0].clientY : e.clientY;

      console.log(clientX, clientY)

      currX = clientX - canvas.getBoundingClientRect().left;
      currY = clientY - canvas.getBoundingClientRect().top;

      // console.log(currX, currY)

      if (!prevX && !prevY) {
        prevX = currX;
        prevY = currY;
      }

      ctx.beginPath();
      ctx.moveTo(prevX, prevY);
      ctx.lineTo(currX, currY);
      ctx.strokeStyle = 'black';
      ctx.lineWidth = 2;
      ctx.stroke();
      ctx.closePath();

      prevX = currX;
      prevY = currY;
    }

    function clearSignature(e) {
      ctx = canvas.getContext('2d');
      ctx.clearRect(0, 0, canvas.width, canvas.height);

      signature.value = "";
    }

    // function onSubmit(e) {
    //     console.log({
    //         'name': document.getElementsByName('name')[0].value,
    //         'signature': signature.value,
    //     });
    //     return false;
    // }



    document.querySelectorAll('.eval-cell').forEach(cell => {
      cell.addEventListener('click', () => {
        const row = cell.dataset.row;
        const value = cell.dataset.value;

        // ניקוי כל תאי השורה
        document.querySelectorAll(`.eval-cell[data-row="${row}"]`).forEach(c => {
          c.textContent = "";
          c.classList.remove("selected");
        });

        // סימון התא
        cell.textContent = "X";
        cell.classList.add("selected");

        // עדכון select הנסתר
        const select = document.getElementById(`hidden-input-${row}`);
        select.value = value;
        console.log("changing", select.id, select.value)
      });

    });

    function restoreSelectionsFromInputs() {
      const rows = document.querySelectorAll('.eval-table tbody tr');

      rows.forEach((row, rowIndex) => {
        const select = document.getElementById(`hidden-input-${rowIndex}`);
        const selectedValue = select.value;

        if (!selectedValue) return;

        // Clear all cells in the row
        row.querySelectorAll(`.eval-cell[data-row="${rowIndex}"]`).forEach(cell => {
          cell.textContent = "";
          cell.classList.remove("selected");
        });

        // Re-select the correct cell
        const cellToMark = row.querySelector(`.eval-cell[data-row="${rowIndex}"][data-value="${selectedValue}"]`);
        if (cellToMark) {
          cellToMark.textContent = "X";
          cellToMark.classList.add("selected");
        }
      });
    }

    function disableSelecting() {
      document.querySelectorAll('.eval-cell').forEach(cell => {
        cell.style.pointerEvents = "none"
      });
    }

    function destroyTableX() {

      const rows = document.querySelectorAll('.eval-table tbody tr');

      rows.forEach((row, rowIndex) => {
        row.querySelectorAll(`.eval-cell[data-row="${rowIndex}"]`).forEach(cell => {
          cell.textContent = "";
          cell.classList.remove("selected");
        });
      });
    }

    // document.getElementById("tsup").addEventListener("click", destroyTableX)
    // document.getElementById("tsup2").addEventListener("click", restoreSelectionsFromInputs)

  </script>


</body>

</html>